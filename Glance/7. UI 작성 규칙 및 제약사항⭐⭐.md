> [!TIP] ğŸ—£ï¸ í•µì‹¬ë‚´ìš©
Composeì™€ ìœ ì‚¬í•˜ì§€ë§Œ ë‹¤ë¥¸ Glanceë§Œì˜ ì»´í¬ì €ë¸”ê³¼ ì œì•½ì‚¬í•­ì„ ì‚´í´ë´…ë‹ˆë‹¤.
>

## 1. Glance DSL ê°œìš”

GlanceëŠ” Composeì™€ **ë¹„ìŠ·í•˜ì§€ë§Œ ë‹¤ë¥¸** DSLì…ë‹ˆë‹¤. ë‚´ë¶€ì ìœ¼ë¡œ RemoteViewsë¡œ ë³€í™˜ë˜ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ ì œì•½ì‚¬í•­ì´ ìˆìŠµë‹ˆë‹¤.

### 1.0 ì™œ ì œì•½ì´ ìˆëŠ”ê°€? (RemoteViews ê¸°ë°˜)

```
ğŸ¨ Glance ë Œë”ë§ íë¦„
ê°œë°œì: Glance DSL ì‘ì„± (Compose ìŠ¤íƒ€ì¼)
       â†“
Glance: ìë™ìœ¼ë¡œ RemoteViews ë³€í™˜ âš™ï¸
       â†“
ì‹œìŠ¤í…œ: RemoteViews â†’ AppWidgetHostView
       â†“
í™”ë©´: ì‹¤ì œ ìœ„ì ¯ UI í‘œì‹œ
```

> [!NOTE] ğŸ’¬ ë°œí‘œ ì„¤ëª…
> "**ì™œ ì œì•½ì´ ìˆì„ê¹Œìš”?** GlanceëŠ” ê²‰ìœ¼ë¡œëŠ” Composeì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ì‹¤ì œë¡œëŠ” **RemoteViews**ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.
>
> RemoteViewsëŠ” Android ìœ„ì ¯ ì‹œìŠ¤í…œì˜ ê·¼ê°„ì´ì—ìš”. ë³„ë„ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì‹¤í–‰ë˜ëŠ” UIë¥¼ í‘œí˜„í•˜ê¸° ìœ„í•œ 'ì‹œë¦¬ì–¼ë¼ì´ì¦ˆ ê°€ëŠ¥í•œ UI êµ¬ì¡°ì²´'ì…ë‹ˆë‹¤. ì¼ë°˜ Viewì²˜ëŸ¼ ë©”ëª¨ë¦¬ì— ê°ì²´ê°€ ìˆëŠ” ê²Œ ì•„ë‹ˆë¼, **ì„¤ëª…ì„œ(description)**ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ì‹ì´ì£ .
>
> ê·¸ë˜ì„œ Composeì˜ ëª¨ë“  ê¸°ëŠ¥ì„ ì“¸ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:
> - âŒ `remember`: ìƒíƒœë¥¼ ë©”ëª¨ë¦¬ì— ìœ ì§€í•  ìˆ˜ ì—†ìŒ (í”„ë¡œì„¸ìŠ¤ê°€ ìˆ˜ì‹œë¡œ ì¢…ë£Œë¨)
> - âŒ `LaunchedEffect`: ì½”ë£¨í‹´ ì‹¤í–‰ ë¶ˆê°€ (ì‹œë¦¬ì–¼ë¼ì´ì¦ˆ ë¶ˆê°€)
> - âŒ ë³µì¡í•œ ì• ë‹ˆë©”ì´ì…˜: RemoteViewsê°€ ì§€ì›í•˜ì§€ ì•ŠìŒ
>
> GlanceëŠ” ì´ëŸ° RemoteViewsì˜ í•œê³„ë¥¼ ê°€ì§„ ì±„ë¡œ, **ìµœëŒ€í•œ ComposeìŠ¤ëŸ½ê²Œ** ì“¸ ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ë˜í¼ì…ë‹ˆë‹¤."

**í•µì‹¬**: Glance DSL â†’ (ìë™ ë³€í™˜) â†’ RemoteViews â†’ ìœ„ì ¯ UI

```xml

### 1.1 ì „í†µ ìœ„ì ¯ê³¼ì˜ UI ì‘ì„± ë°©ì‹ ë¹„êµ

**ì „í†µ ìœ„ì ¯ (XML + RemoteViews)**
```xml
<!-- res/layout/widget_layout.xml -->
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:padding="16dp"
    android:background="#FFFFFF">

    <TextView
        android:id="@+id/title_text"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:textSize="18sp"
        android:textStyle="bold" />

    <Button
        android:id="@+id/action_button"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="Click Me" />
</LinearLayout>
```

```kotlin
// RemoteViewsë¡œ ìˆ˜ë™ ì¡°ì‘
class TraditionalWidget : AppWidgetProvider() {
    override fun onUpdate(
        context: Context,
        appWidgetManager: AppWidgetManager,
        appWidgetIds: IntArray
    ) {
        appWidgetIds.forEach { appWidgetId ->
            val views = RemoteViews(context.packageName, R.layout.widget_layout)

            // í…ìŠ¤íŠ¸ ì„¤ì •
            views.setTextViewText(R.id.title_text, "Hello Widget")

            // í´ë¦­ ì´ë²¤íŠ¸
            val intent = Intent(context, RefreshAction::class.java)
            val pendingIntent = PendingIntent.getBroadcast(
                context, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT
            )
            views.setOnClickPendingIntent(R.id.action_button, pendingIntent)

            appWidgetManager.updateAppWidget(appWidgetId, views)
        }
    }
}
```

**Glance ìœ„ì ¯ (Compose DSL)**
```kotlin
// XML ë¶ˆí•„ìš”, ì„ ì–¸í˜• DSLë¡œ ì§ì ‘ ì‘ì„±
class ModernWidget : GlanceAppWidget() {
    override suspend fun provideGlance(context: Context, id: GlanceId) {
        provideContent {
            Column(
                modifier = GlanceModifier
                    .fillMaxSize()
                    .padding(16.dp)
                    .background(Color.White)
            ) {
                Text(
                    text = "Hello Widget",
                    style = TextStyle(fontSize = 18.sp, fontWeight = FontWeight.Bold)
                )

                Button(
                    text = "Click Me",
                    onClick = actionRunCallback<RefreshAction>()
                )
            }
        }
    }
}
```

**í•µì‹¬ ì°¨ì´ì **:
- **ì „í†µ ë°©ì‹**: XML ë ˆì´ì•„ì›ƒ + RemoteViews APIë¡œ ìˆ˜ë™ ì¡°ì‘
- **Glance ë°©ì‹**: Compose ìŠ¤íƒ€ì¼ DSLë¡œ ì„ ì–¸ì  UI ì‘ì„± (XML ë¶ˆí•„ìš”)
- **ê°œë°œ ê²½í—˜**: ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ëŒ€í­ ê°ì†Œ, íƒ€ì… ì•ˆì •ì„± í–¥ìƒ

---

## 2. ì‚¬ìš© ê°€ëŠ¥í•œ ì»´í¬ì €ë¸”

### 2.1 ë ˆì´ì•„ì›ƒ ì»´í¬ë„ŒíŠ¸

#### Column
```kotlin
Column(
    modifier = GlanceModifier
        .fillMaxSize()
        .padding(16.dp),
    verticalAlignment = Alignment.CenterVertically,
    horizontalAlignment = Alignment.CenterHorizontally
) {
    Text("Item 1")
    Text("Item 2")
    Text("Item 3")
}
```

#### Row
```kotlin
Row(
    modifier = GlanceModifier.fillMaxWidth(),
    verticalAlignment = Alignment.CenterVertically,
    horizontalAlignment = Alignment.Start
) {
    Image(ImageProvider(R.drawable.icon), contentDescription = "Icon")
    Spacer(GlanceModifier.width(8.dp))
    Text("Label")
}
```

#### Box
```kotlin
Box(
    modifier = GlanceModifier.size(100.dp),
    contentAlignment = Alignment.Center
) {
    // ê²¹ì³ì„œ ë°°ì¹˜
    Image(ImageProvider(R.drawable.background), contentDescription = null)
    Text("Overlay Text")
}
```

---

### 2.2 ê¸°ë³¸ UI ì»´í¬ë„ŒíŠ¸

#### Text
```kotlin
Text(
    text = "Hello, Glance!",
    style = TextStyle(
        fontSize = 18.sp,
        fontWeight = FontWeight.Bold,
        color = ColorProvider(Color.Black),
        textAlign = TextAlign.Center
    ),
    maxLines = 2
)
```

#### Image
```kotlin
// ë¦¬ì†ŒìŠ¤ì—ì„œ
Image(
    provider = ImageProvider(R.drawable.icon),
    contentDescription = "Icon",
    modifier = GlanceModifier.size(48.dp)
)

// URIì—ì„œ
Image(
    provider = ImageProvider(Uri.parse("content://...")),
    contentDescription = "Profile",
    contentScale = ContentScale.Crop
)

// Bitmap (ë©”ëª¨ë¦¬ ì£¼ì˜)
Image(
    provider = ImageProvider(bitmap),
    contentDescription = "Dynamic"
)
```

#### Button
```kotlin
Button(
    text = "ìƒˆë¡œê³ ì¹¨",
    onClick = actionRunCallback<RefreshAction>(),
    modifier = GlanceModifier.fillMaxWidth(),
    style = TextStyle(fontSize = 14.sp),
    enabled = true
)
```

#### Spacer
```kotlin
Column {
    Text("First")
    Spacer(GlanceModifier.height(16.dp))
    Text("Second")
}
```

---

### 2.3 Material3 ì»´í¬ë„ŒíŠ¸ (glance-material3 í•„ìš”)

```kotlin
import androidx.glance.material3.*

// Material3 Button
Button(
    text = "Material Button",
    onClick = actionRunCallback<MyAction>(),
    colors = ButtonDefaults.buttonColors()
)

// CircularProgressIndicator
CircularProgressIndicator()

// LinearProgressIndicator
LinearProgressIndicator(
    progress = 0.7f,
    modifier = GlanceModifier.fillMaxWidth()
)

// Switch
Switch(
    checked = isEnabled,
    onCheckedChange = actionRunCallback<ToggleAction>(),
    text = "Enable Feature"
)

// CheckBox
CheckBox(
    checked = isSelected,
    onCheckedChange = actionRunCallback<SelectAction>(),
    text = "Agree to terms"
)
```

**[ìŠ¤í¬ë¦°ìƒ· ì¶”ì²œ]** Material3 ì»´í¬ë„ŒíŠ¸ ëª¨ìŒ (Button, Switch, CheckBox, Progress)

---

## 3. Modifier ì‹œìŠ¤í…œ

### 3.1 ì‚¬ìš© ê°€ëŠ¥í•œ Modifier

```kotlin
GlanceModifier
    // í¬ê¸°
    .fillMaxSize()
    .fillMaxWidth()
    .fillMaxHeight()
    .width(100.dp)
    .height(50.dp)
    .size(48.dp)
    .defaultWeight()  // Row/Columnì—ì„œ ë‚¨ì€ ê³µê°„ ì°¨ì§€

    // ê°„ê²©
    .padding(16.dp)
    .padding(horizontal = 16.dp, vertical = 8.dp)
    .padding(start = 8.dp, top = 4.dp, end = 8.dp, bottom = 4.dp)

    // ë°°ê²½
    .background(Color.White)
    .background(ImageProvider(R.drawable.bg))

    // í…Œë‘ë¦¬
    .border(width = 2.dp, color = Color.Black)
    .cornerRadius(8.dp)

    // í´ë¦­
    .clickable(onClick = actionRunCallback<MyAction>())

    // ê°€ì‹œì„±
    .visibility(visible = isVisible)
```

---

### 3.2 ì‚¬ìš© ë¶ˆê°€ëŠ¥í•œ Modifier

```kotlin
// âŒ Composeì—ëŠ” ìˆì§€ë§Œ Glanceì—ëŠ” ì—†ìŒ
.rotate(45f)              // íšŒì „ ë¶ˆê°€
.scale(1.5f)              // ìŠ¤ì¼€ì¼ ë¶ˆê°€
.alpha(0.5f)              // íˆ¬ëª…ë„ ì¡°ì ˆ ì œí•œì 
.offset(x = 10.dp)        // ì˜¤í”„ì…‹ ë¶ˆê°€
.blur(radius = 4.dp)      // ë¸”ëŸ¬ ë¶ˆê°€
.shadow(elevation = 8.dp) // ê·¸ë¦¼ì ë¶ˆê°€
.clip(CircleShape)        // ë³µì¡í•œ í´ë¦¬í•‘ ë¶ˆê°€
```

---

## 4. ì œì•½ì‚¬í•­

### 4.1 Compose ëŸ°íƒ€ì„ API ì‚¬ìš© ë¶ˆê°€

```kotlin
// âŒ ëª¨ë‘ ì‚¬ìš© ë¶ˆê°€
provideContent {
    var count by remember { mutableStateOf(0) }  // remember ë¶ˆê°€

    LaunchedEffect(Unit) {  // LaunchedEffect ë¶ˆê°€
        delay(1000)
    }

    DisposableEffect(Unit) {  // DisposableEffect ë¶ˆê°€
        onDispose { }
    }

    val context = LocalContext.current  // LocalContext ì œí•œì 

    derivedStateOf { }  // derivedStateOf ë¶ˆê°€
}
```

> [!NOTE] ğŸ’¬ ë°œí‘œ ì„¤ëª…
> "Glance DSLì´ Composeì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, **Compose ëŸ°íƒ€ì„ì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤**. ì´ê²Œ ê°€ì¥ ì¤‘ìš”í•œ ì œì•½ì‚¬í•­ì…ë‹ˆë‹¤.
>
> `remember`ë¡œ ìƒíƒœë¥¼ ë§Œë“¤ ìˆ˜ ì—†ê³ , `LaunchedEffect`ë¡œ ë¹„ë™ê¸° ì‘ì—…ì„ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. GlanceëŠ” ê²°êµ­ RemoteViewsë¡œ ë³€í™˜ë˜ê¸° ë•Œë¬¸ì—, Composeì˜ ëŸ°íƒ€ì„ ê¸°ëŠ¥ë“¤ì„ ì“¸ ìˆ˜ ì—†ëŠ” ê±°ì£ .
>
> ê·¸ëŸ¼ ìƒíƒœëŠ” ì–´ë–»ê²Œ ê´€ë¦¬í•˜ëƒ? `currentState()`ë¡œ ì½ê³ , `updateAppWidgetState()`ë¡œ ì“°ë©´ ë©ë‹ˆë‹¤. ì´ê±´ DataStore ê¸°ë°˜ì´ë¼ ì•ˆì „í•˜ê³ , ìœ„ì ¯ ì¬ì‹œì‘ í›„ì—ë„ ìœ ì§€ë©ë‹ˆë‹¤."

**í•´ê²°ì±…**: ìƒíƒœëŠ” `currentState()` + `updateAppWidgetState()` ì‚¬ìš©

```kotlin
// âœ… Glance ë°©ì‹
provideContent {
    val prefs = currentState<Preferences>()
    val count = prefs[intPreferencesKey("count")] ?: 0

    Column {
        Text("Count: $count")
        Button(
            text = "+1",
            onClick = actionRunCallback<IncrementAction>()
        )
    }
}
```

---

### 4.2 ì œí•œëœ ë ˆì´ì•„ì›ƒ

```kotlin
// âœ… ì§€ì›ë˜ëŠ” ë ˆì´ì•„ì›ƒ
LazyColumn { }           // âœ… ì„¸ë¡œ ìŠ¤í¬ë¡¤ ë¦¬ìŠ¤íŠ¸ ì§€ì› (ëŸ°ì²˜ì— ë”°ë¼ ë™ì‘ ì œí•œ ê°€ëŠ¥)
Scaffold { }             // âœ… Glance 1.1+ ì§€ì›

// âŒ ì‚¬ìš© ë¶ˆê°€
LazyRow { }              // âŒ ê°€ë¡œ ìŠ¤í¬ë¡¤ ë¦¬ìŠ¤íŠ¸ ë¯¸ì§€ì›
ConstraintLayout { }     // âŒ RemoteViews ì œì•½ìœ¼ë¡œ ë¯¸ì§€ì›
```

> [!NOTE] ğŸ’¬ LazyColumn ì‚¬ìš© ì‹œ ì£¼ì˜ì‚¬í•­
> LazyColumnì€ Glanceì—ì„œ ì§€ì›ë˜ì§€ë§Œ, ëŸ°ì²˜ì— ë”°ë¼ ìŠ¤í¬ë¡¤ ë™ì‘ì´ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¼ë¶€ ëŸ°ì²˜ì—ì„œëŠ” ìŠ¤í¬ë¡¤ì´ ì›í™œí•˜ì§€ ì•Šê±°ë‚˜, í•­ëª©ì´ ë§ì„ ê²½ìš° ì„±ëŠ¥ ì´ìŠˆê°€ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, í•­ëª© ìˆ˜ë¥¼ ì œí•œí•˜ê±°ë‚˜ ê³ ì • ë ˆì´ì•„ì›ƒì„ ê³ ë ¤í•˜ì„¸ìš”.

```kotlin
// âœ… LazyColumn ì‚¬ìš© ì˜ˆì œ (ëŸ°ì²˜ ì§€ì› ì‹œ)
LazyColumn {
    items(todoList) { todo ->
        TodoItem(todo)
    }
}

// âœ… ëŒ€ì•ˆ: ì œí•œëœ í•­ëª© ìˆ˜ë¡œ ê³ ì • ë ˆì´ì•„ì›ƒ (í˜¸í™˜ì„± ìš°ì„ )
Column {
    items.take(5).forEach { item ->  // ìµœëŒ€ 5ê°œë§Œ í‘œì‹œ
        ItemRow(item)
    }
    if (items.size > 5) {
        Text("... ${items.size - 5}ê°œ ë”")
    }
}
```

**[ìŠ¤í¬ë¦°ìƒ· ì¶”ì²œ]** ê³ ì •ëœ í•­ëª© ìˆ˜ ìœ„ì ¯ (5ê°œ + "... Nê°œ ë”" ë©”ì‹œì§€)

---

### 4.3 ì• ë‹ˆë©”ì´ì…˜ ì œì•½

```kotlin
// âŒ ì§ì ‘ ì• ë‹ˆë©”ì´ì…˜ ë¶ˆê°€
animate* { }
Animatable
Transition
```

**ëŒ€ì•ˆ**: ìƒíƒœ ë³€ê²½ìœ¼ë¡œ UIë¥¼ ë‹¨ê³„ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸

```kotlin
// âœ… ë‹¨ê³„ì  ìƒíƒœ ì—…ë°ì´íŠ¸ë¡œ ìœ ì‚¬ ì• ë‹ˆë©”ì´ì…˜
class AnimateProgressAction : ActionCallback {
    override suspend fun onAction(
        context: Context,
        glanceId: GlanceId,
        parameters: ActionParameters
    ) {
        for (progress in 0..100 step 10) {
            updateAppWidgetState(context, glanceId) { prefs ->
                prefs[intPreferencesKey("progress")] = progress
            }
            MyWidget().update(context, glanceId)
            delay(100)  // 100ms ê°„ê²©
        }
    }
}
```

---

### 4.4 ë‹¨ìœ„ ì°¨ì´

```kotlin
// âŒ Composeì˜ dp
import androidx.compose.ui.unit.dp  // ìœ„ì ¯ì—ì„œ ì‚¬ìš© ë¶ˆê°€!

// âœ… Glanceì˜ dp
import androidx.glance.unit.dp  // ë°˜ë“œì‹œ ì´ê±¸ ì‚¬ìš©

Text(
    text = "Hello",
    style = TextStyle(fontSize = 16.sp)  // spëŠ” ë™ì¼
)
```

> [!NOTE] ğŸ’¬ ë°œí‘œ ì„¤ëª…
> "ì‹¤ìˆ˜í•˜ê¸° ì‰¬ìš´ ë¶€ë¶„ì´ **ë‹¨ìœ„**ì…ë‹ˆë‹¤.
>
> Composeì—ì„œ ì“°ë˜ `androidx.compose.ui.unit.dp`ë¥¼ importí•˜ë©´ ì»´íŒŒì¼ ì—ëŸ¬ê°€ ë‚©ë‹ˆë‹¤. Glanceì—ì„œëŠ” ë°˜ë“œì‹œ `androidx.glance.unit.dp`ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
>
> ì´ê±´ Glanceê°€ Composeì™€ ë³„ê°œì˜ ì‹œìŠ¤í…œì´ë¼ëŠ” ê±¸ ë³´ì—¬ì£¼ëŠ” ì¢‹ì€ ì˜ˆì‹œì…ë‹ˆë‹¤. ë¹„ìŠ·í•´ ë³´ì´ì§€ë§Œ ê·¼ë³¸ì ìœ¼ë¡œ ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì£ .
>
> `sp`ëŠ” ë™ì¼í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."

---

## 5. ì´ë¯¸ì§€ ì²˜ë¦¬

### 5.1 ì´ë¯¸ì§€ ì†ŒìŠ¤

```kotlin
// âœ… ë¦¬ì†ŒìŠ¤ (ê¶Œì¥)
ImageProvider(R.drawable.icon)

// âœ… URI
ImageProvider(Uri.parse("content://media/external/images/media/123"))

// âœ… Bitmap (ì‘ì€ ì´ë¯¸ì§€ë§Œ)
ImageProvider(smallBitmap)
```

> [!WARNING] ğŸš« provideContent ë‚´ë¶€ì—ì„œ Coil/Glide ì§ì ‘ ì‚¬ìš© ë¶ˆê°€
> **provideContent ë‚´ë¶€ (UI ì„ ì–¸ ë‹¨ê³„)**:
> - âŒ Coil/Glide ê°™ì€ ì¼ë°˜ Android View ê¸°ë°˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© ë¶ˆê°€
> - âŒ RemoteViewsë¡œ ë³€í™˜ë˜ëŠ” ë‹¨ê³„ì´ë¯€ë¡œ Glance DSLë§Œ ì‚¬ìš© ê°€ëŠ¥
>
> **Worker/ActionCallback (ìœ„ì ¯ ì™¸ë¶€)**:
> - âœ… Coil/Glide ì‚¬ìš© ê°€ëŠ¥!
> - âœ… ë°±ê·¸ë¼ìš´ë“œ ì‘ì—…ì´ë¯€ë¡œ ì¼ë°˜ Android API ëª¨ë‘ ì‚¬ìš© ê°€ëŠ¥
> - âœ… ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ í›„ íŒŒì¼/URI/Bitmapìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì „ë‹¬

### 5.2 ë„¤íŠ¸ì›Œí¬ ì´ë¯¸ì§€ ë¡œë”©

> [!TIP] ğŸ’¡ í•µì‹¬ íŒ¨í„´
> Workerì—ì„œ Glide/Coilë¡œ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ â†’ íŒŒì¼ ì €ì¥ â†’ URIë¥¼ DataStoreì— ì €ì¥ â†’ provideContentì—ì„œ URIë¡œ í‘œì‹œ

```kotlin
class LoadImageWorker(context: Context, params: WorkerParameters)
    : CoroutineWorker(context, params) {

    override suspend fun doWork(): Result {
        val imageUrl = inputData.getString("image_url") ?: return Result.failure()
        val glanceId = inputData.getString("glance_id") ?: return Result.failure()

        return try {
            // 1. âœ… Workerì—ì„œëŠ” Glide ì‚¬ìš© ê°€ëŠ¥!
            val bitmap = Glide.with(applicationContext)
                .asBitmap()
                .load(imageUrl)
                .override(200, 200)  // ë¦¬ì‚¬ì´ì¦ˆ
                .submit()
                .get()

            // 2. íŒŒì¼ë¡œ ì €ì¥
            val file = File(applicationContext.cacheDir, "widget_image_$glanceId.png")
            file.outputStream().use { out ->
                bitmap.compress(Bitmap.CompressFormat.PNG, 90, out)
            }

            // 3. ìƒíƒœ ì—…ë°ì´íŠ¸ (URI ì €ì¥)
            val uri = FileProvider.getUriForFile(
                applicationContext,
                "${applicationContext.packageName}.fileprovider",
                file
            )

            updateAppWidgetState(applicationContext, glanceId.toGlanceId()) { prefs ->
                prefs[stringPreferencesKey("image_uri")] = uri.toString()
            }

            MyWidget().update(applicationContext, glanceId.toGlanceId())

            Result.success()
        } catch (e: Exception) {
            Result.failure()
        }
    }
}

// âŒ provideContentì—ì„œëŠ” Glide ì‚¬ìš© ë¶ˆê°€
// âœ… Workerì—ì„œ ì¤€ë¹„í•œ URIë¥¼ ì‚¬ìš©
provideContent {
    val prefs = currentState<Preferences>()
    val imageUriString = prefs[stringPreferencesKey("image_uri")]

    if (imageUriString != null) {
        Image(
            provider = ImageProvider(Uri.parse(imageUriString)),
            contentDescription = "Downloaded",
            modifier = GlanceModifier.size(100.dp)
        )
    } else {
        CircularProgressIndicator()
    }
}
```

**[ë¹„ë””ì˜¤ ì¶”ì²œ]** Workerê°€ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ â†’ ìœ„ì ¯ì— í‘œì‹œë˜ëŠ” ê³¼ì •

---

## 6. ë°˜ì‘í˜• UI íŒ¨í„´

### 6.1 í¬ê¸° ê¸°ë°˜ ë¶„ê¸°

```kotlin
override suspend fun provideGlance(context: Context, id: GlanceId) {
    provideContent {
        val size = LocalSize.current

        when {
            size.width < 150.dp -> CompactUI()
            size.width < 250.dp -> MediumUI()
            else -> ExpandedUI()
        }
    }
}

@Composable
fun CompactUI() {
    Box(
        modifier = GlanceModifier.fillMaxSize().background(Color.LightGray),
        contentAlignment = Alignment.Center
    ) {
        Text("S", style = TextStyle(fontSize = 24.sp))
    }
}

@Composable
fun MediumUI() {
    Column(
        modifier = GlanceModifier.fillMaxSize().padding(8.dp)
    ) {
        Text("Medium", style = TextStyle(fontSize = 16.sp))
        Spacer(GlanceModifier.height(4.dp))
        Button("Action", onClick = actionRunCallback<MyAction>())
    }
}

@Composable
fun ExpandedUI() {
    Row(
        modifier = GlanceModifier.fillMaxSize().padding(16.dp)
    ) {
        Column(modifier = GlanceModifier.defaultWeight()) {
            Text("Left Panel", style = TextStyle(fontSize = 18.sp, fontWeight = FontWeight.Bold))
            Text("More content here")
        }
        Spacer(GlanceModifier.width(16.dp))
        Column(modifier = GlanceModifier.defaultWeight()) {
            Text("Right Panel")
            Button("Action 1", onClick = actionRunCallback<Action1>())
            Button("Action 2", onClick = actionRunCallback<Action2>())
        }
    }
}
```

**[ìŠ¤í¬ë¦°ìƒ· ì¶”ì²œ]** 3ê°€ì§€ í¬ê¸°ë³„ UI ë³€í™” (Compact, Medium, Expanded)

---

### 6.2 ìƒíƒœ ê¸°ë°˜ UI

```kotlin
@Composable
fun DynamicContent() {
    val prefs = currentState<Preferences>()
    val status = prefs[stringPreferencesKey("status")] ?: "idle"
    val data = prefs[stringPreferencesKey("data")]

    when (status) {
        "loading" -> LoadingState()
        "success" -> SuccessState(data ?: "")
        "error" -> ErrorState(prefs[stringPreferencesKey("error_msg")])
        else -> IdleState()
    }
}

@Composable
fun LoadingState() {
    Box(
        modifier = GlanceModifier.fillMaxSize(),
        contentAlignment = Alignment.Center
    ) {
        Column(horizontalAlignment = Alignment.CenterHorizontally) {
            CircularProgressIndicator()
            Spacer(GlanceModifier.height(8.dp))
            Text("ë¡œë”© ì¤‘...")
        }
    }
}

@Composable
fun SuccessState(data: String) {
    Column(
        modifier = GlanceModifier.fillMaxSize().padding(16.dp)
    ) {
        Text("âœ… ì„±ê³µ", style = TextStyle(fontWeight = FontWeight.Bold))
        Spacer(GlanceModifier.height(8.dp))
        Text(data)
        Spacer(GlanceModifier.defaultWeight())
        Button("ìƒˆë¡œê³ ì¹¨", onClick = actionRunCallback<RefreshAction>())
    }
}

@Composable
fun ErrorState(message: String?) {
    Column(
        modifier = GlanceModifier.fillMaxSize().padding(16.dp),
        verticalAlignment = Alignment.CenterVertically,
        horizontalAlignment = Alignment.CenterHorizontally
    ) {
        Text("âŒ ì˜¤ë¥˜", style = TextStyle(color = ColorProvider(Color.Red), fontWeight = FontWeight.Bold))
        Spacer(GlanceModifier.height(8.dp))
        Text(message ?: "ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜")
        Spacer(GlanceModifier.height(16.dp))
        Button("ì¬ì‹œë„", onClick = actionRunCallback<RetryAction>())
    }
}
```

---

## 7. ì ‘ê·¼ì„±

### 7.1 contentDescription

```kotlin
// âœ… ëª¨ë“  ì´ë¯¸ì§€ì™€ ë²„íŠ¼ì— ì„¤ëª… ì¶”ê°€
Image(
    provider = ImageProvider(R.drawable.weather_sunny),
    contentDescription = "ë§‘ì€ ë‚ ì”¨"  // TalkBackì´ ì½ìŒ
)

Button(
    text = "ìƒˆë¡œê³ ì¹¨",
    onClick = actionRunCallback<RefreshAction>(),
    modifier = GlanceModifier.semantics {
        contentDescription = "ë‚ ì”¨ ì •ë³´ ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼"
    }
)
```

### 7.2 ì˜ë¯¸ ìˆëŠ” í…ìŠ¤íŠ¸

```kotlin
// âŒ ì•„ì´ì½˜ë§Œ í‘œì‹œ
Button(
    text = "â†»",
    onClick = actionRunCallback<RefreshAction>()
)

// âœ… í…ìŠ¤íŠ¸ë¡œ ëª…í™•íˆ í‘œí˜„
Button(
    text = "ìƒˆë¡œê³ ì¹¨",
    onClick = actionRunCallback<RefreshAction>()
)
```

---

## 8. ì„±ëŠ¥ ê¶Œì¥ì‚¬í•­

### 8.1 UI ë³µì¡ë„ ì œí•œ

```kotlin
// âŒ ë„ˆë¬´ ë³µì¡
Column {
    repeat(50) { index ->
        Row {
            Image(ImageProvider(R.drawable.icon))
            Column {
                Text("Item $index")
                Row {
                    Button("A", onClick = {})
                    Button("B", onClick = {})
                    Button("C", onClick = {})
                }
            }
        }
    }
}

// âœ… ë‹¨ìˆœí•˜ê³  íš¨ìœ¨ì 
Column {
    repeat(5) { index ->  // í•­ëª© ê°œìˆ˜ ì œí•œ
        Row(verticalAlignment = Alignment.CenterVertically) {
            Image(ImageProvider(R.drawable.icon), contentDescription = null)
            Spacer(GlanceModifier.width(8.dp))
            Text("Item $index", modifier = GlanceModifier.defaultWeight())
        }
    }
    if (totalItems > 5) {
        Text("... ${totalItems - 5}ê°œ ë”", style = TextStyle(fontSize = 12.sp))
    }
}
```

### 8.2 ì¡°ê±´ë¶€ ë Œë”ë§

```kotlin
@Composable
fun OptimizedWidget() {
    val prefs = currentState<Preferences>()
    val showDetails = prefs[booleanPreferencesKey("show_details")] ?: false

    Column {
        Text("Title")

        // í•„ìš”í•  ë•Œë§Œ ë Œë”ë§
        if (showDetails) {
            DetailSection()  // ë¬´ê±°ìš´ ì»´í¬ë„ŒíŠ¸
        }
    }
}
```

---

---
