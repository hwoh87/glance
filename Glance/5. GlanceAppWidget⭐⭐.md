> [!TIP] ğŸ—£ï¸ í•µì‹¬ë‚´ìš©
ì‹¤ì œ ìœ„ì ¯ì˜ UIì™€ ë™ì‘ì„ ì •ì˜í•˜ëŠ” í•µì‹¬ í´ë˜ìŠ¤ì…ë‹ˆë‹¤. `provideGlance()` í•¨ìˆ˜ì—ì„œ ìœ„ì ¯ ì»¨í…ì¸ ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.
>

## 1. GlanceAppWidgetì´ë€?

`GlanceAppWidget`ì€ ê¸°ì¡´ í™ˆ í™”ë©´ ìœ„ì ¯(`AppWidget`)ì„ **ComposeìŠ¤ëŸ¬ìš´ DSL**ë¡œ ì‘ì„±í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” Jetpack ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ í•µì‹¬ ë² ì´ìŠ¤ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.

### 1.1 í•µì‹¬ ê°œë…
- ìœ„ì ¯ ê°œë°œì˜ **ì§„ì…ì **
- í™”ë©´ì—ëŠ” Composeê°€ ì§ì ‘ ê·¸ë ¤ì§€ëŠ” ê²Œ ì•„ë‹ˆë¼, Glance DSL â†’ **`RemoteViews`**ë¡œ ë³€í™˜ë˜ì–´ **`AppWidget`** ì‹œìŠ¤í…œ ìœ„ì—ì„œ ë™ì‘
- **ëª©ì **: `RemoteViews`ì˜ ì œì•½(í˜¸í™˜ì„±/í‘œí˜„ë ¥/ê°œë°œ í¸ì˜)ì„ ì™„í™”í•˜ê³ , ì„ ì–¸ì  DSLë¡œ **ê°„ê²°í•˜ê³  ì•ˆì „**í•˜ê²Œ ìœ„ì ¯ì„ ì‘ì„±

---

## 2. ê¸°ë³¸ í…œí”Œë¦¿

```kotlin
class MyWidget : GlanceAppWidget() {
    // 1. ìƒíƒœ ì €ì¥ ë°©ì‹ ì •ì˜
    override val stateDefinition = PreferencesGlanceStateDefinition

    // 2. í¬ê¸° ëŒ€ì‘ ì „ëµ ì •ì˜
    override val sizeMode = SizeMode.Responsive(
        setOf(
            DpSize(180.dp, 110.dp),
            DpSize(250.dp, 150.dp)
        )
    )

    // 3. UI ì œê³µ ë©”ì„œë“œ
    override suspend fun provideGlance(context: Context, id: GlanceId) {
        provideContent {
            WidgetContent()
        }
    }

    // 4. ì‹¤ì œ UI êµ¬ì„±
    @Composable
    private fun WidgetContent() {
        val prefs = currentState<Preferences>()
        val count = prefs[intPreferencesKey("count")] ?: 0

        Column(
            modifier = GlanceModifier.fillMaxSize().padding(16.dp),
            verticalAlignment = Alignment.CenterVertically,
            horizontalAlignment = Alignment.CenterHorizontally
        ) {
            Text(
                text = "Count: $count",
                style = TextStyle(fontSize = 20.sp, fontWeight = FontWeight.Bold)
            )
            Button(
                text = "Increment",
                onClick = actionRunCallback<IncrementAction>()
            )
        }
    }
}
```

> [!NOTE] ğŸ’¬ NOTE
> "ê¸°ë³¸ í…œí”Œë¦¿ì„ ë³´ë©´ GlanceAppWidgetì˜ êµ¬ì¡°ê°€ ëª…í™•í•©ë‹ˆë‹¤.
>
> 1. **stateDefinition**: ìœ„ì ¯ ìƒíƒœë¥¼ ì–´ë–»ê²Œ ì €ì¥í• ì§€ ì •í•©ë‹ˆë‹¤. PreferencesGlanceStateDefinitionì´ ê°€ì¥ ê°„ë‹¨í•˜ê³  ë§ì´ ì”ë‹ˆë‹¤.
>
> 2. **sizeMode**: ìœ„ì ¯ í¬ê¸°ê°€ ë³€ê²½ë  ë•Œ ì–´ë–»ê²Œ ëŒ€ì‘í• ì§€ ì •í•©ë‹ˆë‹¤. Responsiveê°€ ê¶Œì¥ ë°©ì‹ì…ë‹ˆë‹¤.
>
> 3. **provideGlance()**: ìœ„ì ¯ì´ ì—…ë°ì´íŠ¸ë  ë•Œë§ˆë‹¤ í˜¸ì¶œë©ë‹ˆë‹¤. ì—¬ê¸°ì„œ `provideContent` ë¸”ë¡ìœ¼ë¡œ UIë¥¼ ì œê³µí•˜ì£ .
>
> 4. **WidgetContent()**: ì‹¤ì œ UIë¥¼ Compose ìŠ¤íƒ€ì¼ë¡œ ì‘ì„±í•©ë‹ˆë‹¤. `currentState()`ë¡œ ìƒíƒœë¥¼ ì½ê³ , Column/Text/Button ê°™ì€ ì»´í¬ë„ŒíŠ¸ë¡œ í™”ë©´ì„ êµ¬ì„±í•©ë‹ˆë‹¤.
>
> í•µì‹¬ì€ **provideGlance()ê°€ í˜¸ì¶œë˜ëŠ” ì‹œì **ì„ ì´í•´í•˜ëŠ” ê²ë‹ˆë‹¤. ìœ„ì ¯ ì¶”ê°€, ì—…ë°ì´íŠ¸, í¬ê¸° ë³€ê²½, ìƒíƒœ ë³€ê²½ í›„ update() í˜¸ì¶œ ë“± ì—¬ëŸ¬ ìƒí™©ì—ì„œ í˜¸ì¶œë©ë‹ˆë‹¤."

---

## 3. í•µì‹¬ êµ¬ì„± ìš”ì†Œ

### 3.1 `stateDefinition`
ìœ„ì ¯ ìƒíƒœ ì €ì¥ ë°©ì‹ì„ ì •ì˜í•©ë‹ˆë‹¤.

```kotlin
// Preferences ê¸°ë°˜ (ê°„ë‹¨í•œ key-value) - ê°€ì¥ ì¼ë°˜ì 
override val stateDefinition = PreferencesGlanceStateDefinition
```

**ìƒíƒœ ê´€ë¦¬ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ â†’ [6. State ê´€ë¦¬â­](6.%20State%20ê´€ë¦¬â­.md)** ì°¸ê³ 

---

### 3.2 `sizeMode`
ìœ„ì ¯ì´ ë‹¤ì–‘í•œ í¬ê¸°ì—ì„œ ì–´ë–»ê²Œ ë™ì‘í• ì§€ ì •ì˜í•©ë‹ˆë‹¤.

```kotlin
// ë°˜ì‘í˜• (ê¶Œì¥)
override val sizeMode = SizeMode.Responsive(
    setOf(
        DpSize(180.dp, 110.dp),
        DpSize(250.dp, 150.dp)
    )
)
```

**SizeModeì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ â†’ [8. SizeMode](8.%20SizeMode.md)** ì°¸ê³ 

---

### 3.3 `provideGlance()`
ì‹œìŠ¤í…œì´ 'ìœ„ì ¯ì„ ê·¸ë ¤ë¼' í•˜ê³  í˜¸ì¶œí•  ë•Œ ì‹¤í–‰ë˜ëŠ” ë©”ì„œë“œì…ë‹ˆë‹¤.

```kotlin
override suspend fun provideGlance(context: Context, id: GlanceId) {
    // âš ï¸ ì£¼ì˜: provideContent ì™¸ë¶€ì—ì„œ ê°€ë²¼ìš´ ì¤€ë¹„ ì‘ì—…ë§Œ
    // ë¬´ê±°ìš´ I/OëŠ” Workerë¡œ ë¶„ë¦¬ í•„ìš”

    provideContent {
        // âœ… DataStoreì—ì„œ ìƒíƒœ ì½ê¸°ë§Œ
        val prefs = currentState<Preferences>()
        val data = prefs[dataKey] ?: "ê¸°ë³¸ê°’"

        WidgetUI(data)
    }
}
```

**íŠ¹ì§•**
- `suspend` í•¨ìˆ˜ë¡œ ì •ì˜ë˜ì§€ë§Œ **ë¬´ê±°ìš´ I/OëŠ” ê¸ˆì§€**
- `context`: Android Context
- `id`: ìœ„ì ¯ ì¸ìŠ¤í„´ìŠ¤ë¥¼ êµ¬ë¶„í•˜ëŠ” ê³ ìœ  ID (`GlanceId`)

---

### 3.4 `provideContent {}` - UI ì„ ì–¸ ì „ìš© êµ¬ê°„

#### 3.4.1 ê¸°ë³¸ ì‚¬ìš©ë²•

Glance DSLë¡œ UIë¥¼ ì‘ì„±í•˜ëŠ” ë¸”ë¡ì…ë‹ˆë‹¤. **RemoteViewsë¡œ ë³€í™˜ë  UI íŠ¸ë¦¬ë§Œ ì„ ì–¸**í•˜ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤.

```kotlin
provideContent {
    // Glance Composable ì‚¬ìš©
    Column {
        Text("Hello")
        Button("Click", onClick = { /* ... */ })
    }
}
```

#### 3.4.2 âš ï¸ ì¤‘ìš”: provideContentì—ì„œ ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œ ê¸ˆì§€

> [!WARNING] ì™œ provideContentì—ì„œ ë„¤íŠ¸ì›Œí¬/I/Oë¥¼ í•˜ë©´ ì•ˆ ë˜ë‚˜ìš”?
>
> **1. RemoteViews ë³€í™˜ êµ¬ê°„ì˜ íŠ¹ì„±**
> - `provideContent`ëŠ” **"RemoteViewsë¡œ ë³€í™˜ë  UI íŠ¸ë¦¬ë§Œ ì„ ì–¸"**í•˜ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤.
> - Compose ëŸ°íƒ€ì„ ê¸°ëŠ¥(`remember`, `LaunchedEffect`, ì½”ë£¨í‹´ ì»¨í…ìŠ¤íŠ¸)ì´ ë™ì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
> - UI ì„ ì–¸ ì¤‘ì— ë¸”ë¡œí‚¹/I/Oê°€ ë¼ë©´ **ë Œë”ë§ ì‹¤íŒ¨ ë˜ëŠ” ì§€ì—°**ì´ ë°œìƒí•©ë‹ˆë‹¤.
>
> **2. í”„ë¡œì„¸ìŠ¤ ì œì•½**
> - ìœ„ì ¯ì€ **ëŸ°ì²˜ í”„ë¡œì„¸ìŠ¤ì™€ IPCë¡œ ê·¸ë ¤ì§€ëŠ”** ë³„ë„ í”„ë¡œì„¸ìŠ¤/ìŠ¤ë ˆë“œ í™˜ê²½ì…ë‹ˆë‹¤.
> - ì´ í™˜ê²½ì—ì„œ ë„¤íŠ¸ì›Œí¬/DB í˜¸ì¶œì€ **ì•ˆì •ì ì´ì§€ ì•Šê³ **, ANR(Application Not Responding) ìœ„í—˜ì´ ìˆìŠµë‹ˆë‹¤.
>
> **3. ì˜¬ë°”ë¥¸ íŒ¨í„´**
> ```kotlin
> âŒ ì˜ëª»ëœ ì˜ˆ - provideContent ë‚´ë¶€ì—ì„œ ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œ
> provideContent {
>     val data = runBlocking { fetchDataFromNetwork() } // âŒ ANR ìœ„í—˜!
>     Text(data)
> }
>
> âœ… ì˜¬ë°”ë¥¸ ì˜ˆ - Workerì—ì„œ ì¤€ë¹„ â†’ DataStore ì €ì¥ â†’ UIëŠ” ì½ê¸°ë§Œ
> // 1. Workerì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
> class DataUpdateWorker : CoroutineWorker(...) {
>     override suspend fun doWork(): Result {
>         val data = repository.fetchData() // ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œ
>
>         // DataStoreì— ì €ì¥
>         updateAppWidgetState(context, glanceId) { prefs ->
>             prefs[dataKey] = data
>         }
>
>         // UI ê°±ì‹  íŠ¸ë¦¬ê±°
>         MyWidget().update(context, glanceId)
>         return Result.success()
>     }
> }
>
> // 2. UIëŠ” currentState()ë¡œ ì½ê¸°ë§Œ
> provideContent {
>     val prefs = currentState<Preferences>()
>     val data = prefs[dataKey] ?: "ë¡œë”© ì¤‘..."
>     Text(data)
> }
> ```
>
> **ì •ë¦¬**: ë°ì´í„°ëŠ” Worker/Repositoryì—ì„œ ì¤€ë¹„ â†’ DataStoreì— ì €ì¥ â†’ UIëŠ” `currentState()`ë¡œ ì½ê¸°ë§Œ.

#### 3.4.3 ìµœì´ˆ ë¡œë”© UX ê¶Œì¥ íŒ¨í„´
ìœ„ì ¯ì´ ì²˜ìŒ ì¶”ê°€ë˜ì—ˆì„ ë•Œ ë°ì´í„°ê°€ ì—†ëŠ” ìƒíƒœë¥¼ ì²˜ë¦¬í•˜ëŠ” íŒ¨í„´ì…ë‹ˆë‹¤.

```kotlin
@Composable  
fun WidgetContent() {  
    val prefs = currentState<Preferences>()  
    val data = prefs[stringPreferencesKey("weather_data")]  
    val isLoading = prefs[booleanPreferencesKey("is_loading")] ?: false  
    val errorMsg = prefs[stringPreferencesKey("error_message")]  
  
    Column(  
        modifier = GlanceModifier.fillMaxSize().padding(16.dp),  
        verticalAlignment = Alignment.CenterVertically,  
        horizontalAlignment = Alignment.CenterHorizontally  
    ) {  
        when {  
            errorMsg != null -> {  
                Text("âš ï¸ $errorMsg", style = TextStyle(color = Color.Red))  
                Spacer(GlanceModifier.height(8.dp))  
                Button(text = "ìƒˆë¡œê³ ì¹¨", onClick = actionRunCallback<RefreshDataAction>())  
            }  
            isLoading -> {  
                CircularProgressIndicator()  
                Text("ë¡œë”© ì¤‘...", style = TextStyle(color = Color.Gray))  
            }  
            data == null -> {  
                Text("ğŸ“Š ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ë ¤ë©´\nì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”")  
                Spacer(GlanceModifier.height(8.dp))  
                Button(text = "ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°", onClick = actionRunCallback<LoadInitialDataAction>())  
            }  
            else -> {  
                Text(data)  
                Button(text = "ìƒˆë¡œê³ ì¹¨", onClick = actionRunCallback<RefreshDataAction>())  
            }  
        }  
    }  
}  
  
class LoadInitialDataAction : ActionCallback {  
    override suspend fun onAction(  
        context: Context,  
        glanceId: GlanceId,  
        parameters: ActionParameters  
    ) {  
        // 1) UX ë°˜ì‘ì„±: í˜„ì¬ ì¸ìŠ¤í„´ìŠ¤ë§Œ ë¡œë”© í‘œì‹œ  
        updateAppWidgetState(context, glanceId) { prefs ->  
            prefs[booleanPreferencesKey("is_loading")] = true  
            prefs.remove(stringPreferencesKey("error_message"))  
        }  
        MyWidget().update(context, glanceId)  
  
        // 2) Workerì—ëŠ” 'glance_id' ì „ë‹¬ ì—†ì´ ì „ì²´ ê°±ì‹  ì „ëµ  
        WorkManager.getInstance(context).enqueue(  
            OneTimeWorkRequestBuilder<DataFetchWorker>().build()  
        )  
    }  
}  
  
// ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ë„ ë™ì¼ ì „ëµ ì‚¬ìš©  
class RefreshDataAction : ActionCallback {  
    override suspend fun onAction(  
        context: Context,  
        glanceId: GlanceId,  
        parameters: ActionParameters  
    ) {  
        updateAppWidgetState(context, glanceId) { prefs ->  
            prefs[booleanPreferencesKey("is_loading")] = true  
            prefs.remove(stringPreferencesKey("error_message"))  
        }  
        MyWidget().update(context, glanceId)  
  
        WorkManager.getInstance(context).enqueue(  
            OneTimeWorkRequestBuilder<DataFetchWorker>().build()  
        )  
    }  
}
```

**[ìŠ¤í¬ë¦°ìƒ· ì¶”ì²œ]** ìœ„ì ¯ ë¡œë”© â†’ ë°ì´í„° í‘œì‹œ â†’ ì—ëŸ¬ â†’ ì¬ì‹œë„ íë¦„

> [!NOTE] ğŸ’¬ NOTE
> "**ìµœì´ˆ ë¡œë”© UXëŠ” 4ê°€ì§€ ìƒíƒœ**ë¥¼ ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤.
>
> 1. **ì—ëŸ¬ ìƒíƒœ**: ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë“±ì˜ ë©”ì‹œì§€ì™€ 'ìƒˆë¡œê³ ì¹¨' ë²„íŠ¼
> 2. **ë¡œë”© ì¤‘**: ë¡œë”© ì¸ë””ì¼€ì´í„°ë‚˜ 'ë¡œë”© ì¤‘...' í…ìŠ¤íŠ¸
> 3. **ì´ˆê¸° ìƒíƒœ**: ë°ì´í„°ê°€ ì—†ì„ ë•Œ 'ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°' ë²„íŠ¼
> 4. **ì •ìƒ ìƒíƒœ**: ì‹¤ì œ ë°ì´í„° í‘œì‹œ
>
> **í•µì‹¬ íŒ¨í„´**:
> - ActionCallbackì—ì„œ ì¦‰ì‹œ ë¡œë”© ìƒíƒœë¡œ ë³€ê²½ â†’ `update()` í˜¸ì¶œ (ì‚¬ìš©ìì—ê²Œ í”¼ë“œë°±)
> - Workerë¥¼ enqueueí•´ì„œ ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… ìœ„ì„
> - Workerê°€ ì™„ë£Œë˜ë©´ DataStore ì—…ë°ì´íŠ¸ â†’ `update()` í˜¸ì¶œ (ê²°ê³¼ ë°˜ì˜)
>
> ì´ë ‡ê²Œ í•˜ë©´ **UIëŠ” ì ˆëŒ€ ë¸”ë¡œí‚¹ë˜ì§€ ì•Šê³ **, ì‚¬ìš©ìëŠ” ë¡œë”© ìƒíƒœë¥¼ ëª…í™•íˆ ì¸ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."

**Worker êµ¬í˜„ ì˜ˆì‹œ**:
```kotlin
class DataFetchWorker(  
    context: Context,  
    params: WorkerParameters  
) : CoroutineWorker(context, params) {  
  
    override suspend fun doWork(): Result = try {  
        // 1) ë¬´ê±°ìš´ I/O (í•œ ë²ˆë§Œ ìˆ˜í–‰)  
        val data = repository.fetchWeatherData()  
  
        // 2) ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ì— ìƒíƒœ ë°˜ì˜  
        val appContext = applicationContext  
        val widget = MyWidget()  
        val manager = GlanceAppWidgetManager(appContext)  
        val glanceIds = manager.getGlanceIds(widget.javaClass)  
  
        glanceIds.forEach { id ->  
            updateAppWidgetState(appContext, id) { prefs ->  
                prefs[stringPreferencesKey("weather_data")] = data  
                prefs[booleanPreferencesKey("is_loading")] = false  
                prefs.remove(stringPreferencesKey("error_message"))  
            }  
        }  
        // 3) ì „ì²´ ì¬ë Œë”  
        widget.updateAll(appContext)  
        Result.success()  
  
    } catch (e: Exception) {  
        // ì—ëŸ¬ ìƒíƒœë„ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ì— ë°˜ì˜  
        val appContext = applicationContext  
        val widget = MyWidget()  
        val manager = GlanceAppWidgetManager(appContext)  
        val glanceIds = manager.getGlanceIds(widget.javaClass)  
  
        glanceIds.forEach { id ->  
            updateAppWidgetState(appContext, id) { prefs ->  
                prefs[booleanPreferencesKey("is_loading")] = false  
                prefs[stringPreferencesKey("error_message")] =  
                    e.message ?: "ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"  
            }  
        }        widget.updateAll(appContext)  
        Result.failure()  
    }  
}
```

> [!NOTE] ğŸ’¬ ì›Œì»¤ì—ì„œ ê°œë³„ ì—…ë°ì´íŠ¸ ë°©ë²•?
> Â Worker ì˜ˆì‹œ ì½”ë“œì—ì„œ íŠ¹ì • ìœ„ì ¯ì˜ ê°œë³„ì—…ë°ì´íŠ¸ ë°©ë²•ì— ëŒ€í•œ ê³µì‹ê°€ì´ë“œ
> Â - AppWidgetIdëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ê·¸ë£¹ìœ¼ë¡œ ì¡´ì¬í•¨
> Â - ê³µì‹ìœ¼ë¡œëŠ” idë¥¼ ìˆœíšŒí•˜ê±°ë‚˜ ì „ì²´ updateAllì„ í•˜ëŠ” ê°€ì´ë“œë§Œ ì¡´ì¬
> Â - GlanceAppWidgetManagerí†µí•´ idë¥¼ ì–»ëŠ” ë°©ë²•ì´ ìˆì§€ë§Œ ì´í›„ í˜¸í™˜ì„± ë¬¸ì œ ë°œìƒ ìš°ë ¤
> Â - ì¶”í›„ ê´€ë ¨ ë‚´ìš©ì˜ ì—…ë°ì´íŠ¸ê°€ ìƒê¸¸ ìˆ˜ë„ ìˆì–´ ë³´ì„

```kotlin
val glanceIdString = inputData.getString("glance_id") ?: return Result.failure()  
val glanceId = GlanceAppWidgetManager(applicationContext)  
    .getGlanceIds(MyGlanceWidget::class.java)  
    .find { it.toString() == glanceIdString }  
    ?: return Result.failure()
```
---

## 4. Glance ë™ì‘ ì›ë¦¬

### 4.1 ë Œë”ë§ íë¦„

```
ğŸ“± ì‚¬ìš©ìê°€ ìœ„ì ¯ ì¶”ê°€
   â†“
ğŸ“‘ initialLayout ì¦‰ì‹œ í‘œì‹œ (í”Œë ˆì´ìŠ¤í™€ë”)
   â†“
ğŸ“¡ GlanceAppWidgetReceiver í˜¸ì¶œ
   â†“
ğŸ§© provideGlance() ì‹¤í–‰
   â†“
ğŸ¨ provideContent { } - Glance DSL ì‘ì„±
   â†“
ğŸ”„ Glance ì—”ì§„ì´ ìë™ìœ¼ë¡œ RemoteViews ë³€í™˜
   â†“
âœ… ì‹¤ì œ ìœ„ì ¯ UI í‘œì‹œ
```

> [!NOTE]
> **initialLayout í”Œë ˆì´ìŠ¤í™€ë”**ì— ëŒ€í•œ ìì„¸í•œ ì„¤ëª…ì€ â†’ **[2. GlanceAppWidgetReceiverâ­](2.%20GlanceAppWidgetReceiverâ­.md)** ì„¹ì…˜ 2.1 ì°¸ê³ 

### 4.2 í•µì‹¬ í¬ì¸íŠ¸

- **ì„ ì–¸í˜• UI**: ê°œë°œìëŠ” DSLë§Œ ì‘ì„±
- **ìë™ ë³€í™˜**: Glanceê°€ RemoteViewsë¡œ ë³€í™˜
- **RemoteViews ê¸°ë°˜**: ë”°ë¼ì„œ ì œì•½ì‚¬í•­ ì¡´ì¬ (â†’ [7. UI ì‘ì„± ê·œì¹™](7.%20UI%20ì‘ì„±%20ê·œì¹™%20ë°%20ì œì•½ì‚¬í•­â­â­.md) ì°¸ê³ )

### 4.3 í”„ë¡œì„¸ìŠ¤ ë° ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬

#### 4.3.1 í”„ë¡œì„¸ìŠ¤ ë¶„ë¦¬

ìœ„ì ¯ì€ **ë³„ë„ í”„ë¡œì„¸ìŠ¤**ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤. ì´ í”„ë¡œì„¸ìŠ¤ëŠ” ìì£¼ ì¢…ë£Œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ê¶Œì¥ ì‚¬í•­**:
- ë¬´ê±°ìš´ I/O/ë„¤íŠ¸ì›Œí¬ ì‘ì—…ì€ `Worker`ë‚˜ `Repository`ë¡œ ë¶„ë¦¬
- `provideContent`ëŠ” ë¹ ë¥´ê²Œ `RemoteViews`ë¥¼ ìƒì„±í•´ì•¼ í•¨ (ë¸”ë¡œí‚¹ ê¸ˆì§€)

> [!TIP]
> ìœ„ì ¯ í”„ë¡œì„¸ìŠ¤ëŠ” ëŸ°ì²˜ í”„ë¡œì„¸ìŠ¤ì™€ ë³„ë„ë¡œ ë™ì‘í•˜ë©°, ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ì••ë°• ì‹œ ì–¸ì œë“  ì¢…ë£Œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ìƒíƒœëŠ” í•­ìƒ DataStoreì— ì €ì¥í•˜ê³ , ë¬´ê±°ìš´ ì‘ì—…ì€ Workerë¡œ ë¶„ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤.

#### 4.3.2 ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬

í™ˆ í™”ë©´ì— ê°™ì€ ìœ„ì ¯ì„ ì—¬ëŸ¬ ê°œ ì¶”ê°€í•˜ë©´ ê°ê° ë‹¤ë¥¸ `GlanceId`ë¥¼ ê°€ì§‘ë‹ˆë‹¤.

```kotlin
// ì¸ìŠ¤í„´ìŠ¤ë³„ë¡œ ë…ë¦½ì ì¸ ìƒíƒœ
updateAppWidgetState(context, glanceId1) { prefs ->
    prefs[stringPreferencesKey("location")] = "ì„œìš¸"
}

updateAppWidgetState(context, glanceId2) { prefs ->
    prefs[stringPreferencesKey("location")] = "ë¶€ì‚°"
}

// ê° ì¸ìŠ¤í„´ìŠ¤ëŠ” ë…ë¦½ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸
MyWidget().update(context, glanceId1)  // ì„œìš¸ ë‚ ì”¨ë§Œ ê°±ì‹ 
MyWidget().update(context, glanceId2)  // ë¶€ì‚° ë‚ ì”¨ë§Œ ê°±ì‹ 
```

> [!NOTE]
> ê° ìœ„ì ¯ ì¸ìŠ¤í„´ìŠ¤ëŠ” ê³ ìœ í•œ `GlanceId`ë¥¼ ê°€ì§€ë©°, DataStoreë„ ì¸ìŠ¤í„´ìŠ¤ë³„ë¡œ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬ë©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ê°™ì€ ìœ„ì ¯ì„ ì—¬ëŸ¬ ê°œ ì¶”ê°€í•´ë„ ê°ê° ë‹¤ë¥¸ ì„¤ì •ê³¼ ë°ì´í„°ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---