> [!TIP] ğŸ—£ï¸ í•µì‹¬ë‚´ìš©
ì‚¬ìš©ì ì¸í„°ë™ì…˜ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•: actionRunCallback, actionStartActivity, actionStartService ë“±ì„ ë‹¤ë£¹ë‹ˆë‹¤.
>

## 1. Action ê°œìš”

Glance ìœ„ì ¯ì—ì„œ ì‚¬ìš©ìì˜ í´ë¦­, íƒ­ ë“±ì˜ ì¸í„°ë™ì…˜ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. RemoteViews ê¸°ë°˜ì´ë¯€ë¡œ PendingIntentë¥¼ í†µí•´ ë™ì‘í•©ë‹ˆë‹¤.

```
ğŸ‘† ì‚¬ìš©ì í´ë¦­
   â”‚
   â–¼
ğŸ¯ clickable(onClick = action...)
   â”‚
   â–¼
ğŸ“¡ PendingIntent ì‹¤í–‰
   â”‚
   â”œâ”€â†’ ğŸ”„ `actionRunCallback` (ìœ„ì ¯ ë‚´ë¶€ ë¡œì§)
   â”œâ”€â†’ ğŸ“± `actionStartActivity` (ì•¡í‹°ë¹„í‹° ì‹¤í–‰)
   â”œâ”€â†’ âš™ï¸ `actionStartService` (ì„œë¹„ìŠ¤ ì‹¤í–‰, Deprecated)
   â””â”€â†’ ğŸ“» `actionSendBroadcast` (ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì „ì†¡)
```

---

## 2. Action ìœ í˜•

### 2.1 `actionRunCallback`
- **ê°€ì¥ ë§ì´ ì‚¬ìš©**í•˜ëŠ” ë°©ì‹
- ìœ„ì ¯ ë‚´ë¶€ì—ì„œ **ìƒíƒœ ë³€ê²½ + UI ê°±ì‹ **ì„ ì²˜ë¦¬
- `ActionCallback` ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ í•„ìš”

```kotlin
class CounterWidget : GlanceAppWidget() {
    override suspend fun provideGlance(context: Context, id: GlanceId) {
        provideContent {
            val prefs = currentState<Preferences>()
            val count = prefs[intPreferencesKey("count")] ?: 0

            Column(
                modifier = GlanceModifier.fillMaxSize(),
                verticalAlignment = Alignment.CenterVertically,
                horizontalAlignment = Alignment.CenterHorizontally
            ) {
                Text("Count: $count")
                Button(
                    text = "ì¦ê°€",
                    onClick = actionRunCallback<IncrementAction>()
                )
            }
        }
    }
}

// ActionCallback êµ¬í˜„
class IncrementAction : ActionCallback {
    override suspend fun onAction(
        context: Context,
        glanceId: GlanceId,
        parameters: ActionParameters
    ) {
        // 1. ìƒíƒœ ì—…ë°ì´íŠ¸
        updateAppWidgetState(context, glanceId) { prefs ->
            val current = prefs[intPreferencesKey("count")] ?: 0
            prefs[intPreferencesKey("count")] = current + 1
        }

        // 2. UI ê°±ì‹  (í•„ìˆ˜!)
        CounterWidget().update(context, glanceId)
    }
}
```

> [!NOTE] ğŸ’¬ ë°œí‘œ ì„¤ëª…
> "**ActionCallbackì˜ ì‹¤í–‰ íë¦„**ì„ ì´í•´í•˜ëŠ” ê²Œ ì¤‘ìš”í•©ë‹ˆë‹¤.
>
> 1. **ì‚¬ìš©ì í´ë¦­**: ì‚¬ìš©ìê°€ Buttonì„ íƒ­í•˜ë©´ `onClick = actionRunCallback<IncrementAction>()`ì´ íŠ¸ë¦¬ê±°ë©ë‹ˆë‹¤.
>
> 2. **ì‹œìŠ¤í…œ í˜¸ì¶œ**: Glance ì‹œìŠ¤í…œì´ IncrementAction í´ë˜ìŠ¤ë¥¼ ì°¾ì•„ì„œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ê³  `onAction()` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. ì´ ê³¼ì •ì—ì„œ **ë¦¬í”Œë ‰ì…˜**ì´ ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì— ProGuard ê·œì¹™ì´ í•„ìš”í•œ ê±°ì£ .
>
> 3. **ìƒíƒœ ì—…ë°ì´íŠ¸**: `updateAppWidgetState()`ë¡œ DataStoreì— ìƒˆë¡œìš´ ê°’ì„ ì €ì¥í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ê²ƒë§Œìœ¼ë¡œëŠ” í™”ë©´ì´ ì•ˆ ë°”ë€ë‹ˆë‹¤!
>
> 4. **UI ê°±ì‹ **: `CounterWidget().update()`ë¥¼ í˜¸ì¶œí•´ì•¼ `provideGlance()`ê°€ ë‹¤ì‹œ ì‹¤í–‰ë˜ë©´ì„œ í™”ë©´ì´ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤. **ì´ ë‹¨ê³„ë¥¼ ë¹¼ë¨¹ìœ¼ë©´ í´ë¦­í•´ë„ ì•„ë¬´ ì¼ë„ ì•ˆ ì¼ì–´ë‚˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì…ë‹ˆë‹¤.**
>
> **í•µì‹¬**: ActionCallbackì€ ë‹¨ìˆœíˆ ë¡œì§ë§Œ ì‹¤í–‰í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼ 'ìƒíƒœ ë³€ê²½ â†’ UI ê°±ì‹ ' ë‘ ë‹¨ê³„ë¥¼ ëª¨ë‘ ì±…ì„ì§‘ë‹ˆë‹¤."

**[ìŠ¤í¬ë¦°ìƒ· ì¶”ì²œ]** ë²„íŠ¼ í´ë¦­ ì‹œ ì¹´ìš´í„°ê°€ ì¦ê°€í•˜ëŠ” ìœ„ì ¯ í™”ë©´

---

### 2.2 `actionStartActivity`
- íŠ¹ì • **Activityë¥¼ ì‹¤í–‰**í•  ë•Œ ì‚¬ìš©
- ìœ„ì ¯ì—ì„œ ì•±ì˜ ë©”ì¸ í™”ë©´ì´ë‚˜ íŠ¹ì • ê¸°ëŠ¥ìœ¼ë¡œ ì´ë™

```kotlin
Button(
    text = "ì•± ì—´ê¸°",
    onClick = actionStartActivity<MainActivity>()
)

// íŒŒë¼ë¯¸í„° ì „ë‹¬
Button(
    text = "ìƒì„¸ë³´ê¸°",
    onClick = actionStartActivity(
        Intent(context, DetailActivity::class.java).apply {
            putExtra("item_id", itemId)
        }
    )
)

// ComponentNameìœ¼ë¡œ ì§€ì •
Button(
    text = "ì„¤ì • ì—´ê¸°",
    onClick = actionStartActivity(
        ComponentName(context, SettingsActivity::class.java)
    )
)
```

---

### 2.3 `actionStartService` (Deprecated)
- Android 8.0(API 26)ë¶€í„° ë°±ê·¸ë¼ìš´ë“œ ì„œë¹„ìŠ¤ ì œí•œìœ¼ë¡œ **ì‚¬ìš© ê¶Œì¥í•˜ì§€ ì•ŠìŒ**
- ëŒ€ì‹  **WorkManager** ë˜ëŠ” **`actionRunCallback`**ì—ì„œ ì‘ì—… ì²˜ë¦¬

```kotlin
// âŒ ê¶Œì¥í•˜ì§€ ì•ŠìŒ
onClick = actionStartService<MyService>()

// âœ… ëŒ€ì•ˆ: actionRunCallbackì—ì„œ WorkManager ì‚¬ìš©
class RefreshAction : ActionCallback {
    override suspend fun onAction(
        context: Context,
        glanceId: GlanceId,
        parameters: ActionParameters
    ) {
        // WorkManagerë¡œ ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… ì˜ˆì•½
        val workRequest = OneTimeWorkRequestBuilder<RefreshWorker>().build()
        WorkManager.getInstance(context).enqueue(workRequest)

        // UI ì¦‰ì‹œ ê°±ì‹ 
        MyWidget().update(context, glanceId)
    }
}
```

---

### 2.4 `actionSendBroadcast`
- íŠ¹ì • **BroadcastReceiverë¥¼ í˜¸ì¶œ**í•  ë•Œ ì‚¬ìš©
- ì•±ì˜ íŠ¹ì • ë¦¬ì‹œë²„ë¡œ ë¸Œë¡œë“œìºìŠ¤íŠ¸ë¥¼ ì „ì†¡í•˜ê±°ë‚˜, ì‹œìŠ¤í…œ ë¸Œë¡œë“œìºìŠ¤íŠ¸ë¥¼ ë³´ë‚¼ ë•Œ í™œìš©
- ì•ŒëŒ ì„¤ì •, í† ê¸€ ë™ì‘ ë“±ì— ìœ ìš©

```kotlin
// 1. BroadcastReceiver ì •ì˜
class WidgetBroadcastReceiver : BroadcastReceiver() {
    override fun onReceive(context: Context, intent: Intent) {
        when (intent.action) {
            "com.example.ACTION_TOGGLE" -> {
                val glanceIdString = intent.getStringExtra("glance_id") ?: return
                val glanceId = GlanceId(glanceIdString)

                // ìƒíƒœ í† ê¸€
                GlobalScope.launch {
                    updateAppWidgetState(context, glanceId) { prefs ->
                        val current = prefs[booleanPreferencesKey("enabled")] ?: false
                        prefs[booleanPreferencesKey("enabled")] = !current
                    }
                    MyWidget().update(context, glanceId)
                }
            }
        }
    }
}

// 2. AndroidManifest.xmlì— ë“±ë¡
<receiver android:name=".WidgetBroadcastReceiver"
    android:exported="false">
    <intent-filter>
        <action android:name="com.example.ACTION_TOGGLE" />
    </intent-filter>
</receiver>

// 3. ìœ„ì ¯ì—ì„œ ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì•¡ì…˜ ì‚¬ìš©
Button(
    text = "í† ê¸€",
    onClick = actionSendBroadcast(
        Intent("com.example.ACTION_TOGGLE").apply {
            setPackage(context.packageName)
            putExtra("glance_id", glanceId.toString())
        }
    )
)

// ë˜ëŠ” ComponentNameìœ¼ë¡œ ëª…ì‹œì  í˜¸ì¶œ
Button(
    text = "ëª…ì‹œì  ë¸Œë¡œë“œìºìŠ¤íŠ¸",
    onClick = actionSendBroadcast(
        ComponentName(context, WidgetBroadcastReceiver::class.java),
        Intent("com.example.ACTION_CUSTOM").apply {
            putExtra("data", "value")
        }
    )
)
```

> [!NOTE] ğŸ’¬ actionSendBroadcast ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤
> **actionRunCallbackê³¼ actionSendBroadcastì˜ ì°¨ì´**:
>
> - **actionRunCallback**: ìœ„ì ¯ ì „ìš© ë¡œì§, ìƒíƒœ ê´€ë¦¬ì™€ UI ì—…ë°ì´íŠ¸ê°€ ì£¼ ëª©ì 
> - **actionSendBroadcast**: ì•±ì˜ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì™€ í†µì‹ , ì‹œìŠ¤í…œ ì´ë²¤íŠ¸ ì „ë‹¬
>
> **ì‚¬ìš© ì˜ˆì‹œ**:
> - ì•ŒëŒ ì•±ì˜ ìœ„ì ¯ì—ì„œ ì•ŒëŒ on/off í† ê¸€ â†’ ì•ŒëŒ ë§¤ë‹ˆì €ì— ë¸Œë¡œë“œìºìŠ¤íŠ¸
> - ë¯¸ë””ì–´ ìœ„ì ¯ì—ì„œ ì¬ìƒ/ì¼ì‹œì •ì§€ â†’ ë¯¸ë””ì–´ ì„œë¹„ìŠ¤ì— ë¸Œë¡œë“œìºìŠ¤íŠ¸
> - ìœ„ì ¯ì—ì„œ ì•±ì˜ íŠ¹ì • ê¸°ëŠ¥ íŠ¸ë¦¬ê±° (ì˜ˆ: ë™ê¸°í™”, ìƒˆë¡œê³ ì¹¨)

**[ìŠ¤í¬ë¦°ìƒ· ì¶”ì²œ]** í† ê¸€ ë²„íŠ¼ì´ ìˆëŠ” ìœ„ì ¯ (ë¸Œë¡œë“œìºìŠ¤íŠ¸ë¡œ ìƒíƒœ ë³€ê²½)

---

### 2.5 `action` (ì»¤ìŠ¤í…€ Action)

#### 2.5.1 ì»¤ìŠ¤í…€ Actionì´ ì¡´ì¬í•˜ëŠ” ì´ìœ 

GlanceëŠ” ì´ë¯¸ `actionRunCallback`, `actionStartActivity`, `actionSendBroadcast` ê°™ì€ í¸ë¦¬í•œ ë˜í¼ APIë¥¼ ì œê³µí•©ë‹ˆë‹¤. ê·¸ëŸ°ë° ì™œ ì›ì‹œì ì¸ `action()` APIë¥¼ ì—´ì–´ë†“ì•˜ì„ê¹Œìš”?

> [!NOTE] ì„¤ê³„ ì² í•™: "Escape Hatch" (íƒˆì¶œêµ¬)
> Jetpack Composeì™€ GlanceëŠ” **"ê³ ìˆ˜ì¤€ APIê°€ ì¶©ë¶„í•˜ì§€ ì•Šì„ ë•Œ ì €ìˆ˜ì¤€ìœ¼ë¡œ ì§ì ‘ ì œì–´í•  ìˆ˜ ìˆëŠ” íƒˆì¶œêµ¬"**ë¥¼ ì œê³µí•˜ëŠ” ì² í•™ì„ ë”°ë¦…ë‹ˆë‹¤.
>
> **ë˜í¼ APIì˜ í•œê³„**:
> - `actionRunCallback`: ì•± ë‚´ë¶€ ìœ„ì ¯ ë¡œì§ì—ë§Œ ì í•©
> - `actionStartActivity`: ì•± ë‚´ Activity ì‹¤í–‰ì—ë§Œ ì í•©
> - `actionSendBroadcast`: ë¸Œë¡œë“œìºìŠ¤íŠ¸ë§Œ ì§€ì›
>
> **ì»¤ë²„ë˜ì§€ ì•ŠëŠ” ì‚¬ìš© ì‚¬ë¡€**:
> 1. **ì‹œìŠ¤í…œ ì¸í…íŠ¸**: ì „í™” ê±¸ê¸°, ì•ŒëŒ ì„¤ì •, ë¸Œë¼ìš°ì € ì—´ê¸°, ì‹œìŠ¤í…œ ì„¤ì • ë“±
> 2. **ì¨ë“œíŒŒí‹° ì•± í†µí•©**: ë‹¤ë¥¸ ì•±ì˜ ë”¥ë§í¬, ê³µìœ  ì¸í…íŠ¸
> 3. **PendingIntent ì„¸ë°€ ì œì–´**: í”Œë˜ê·¸(FLAG_IMMUTABLE, FLAG_UPDATE_CURRENT ë“±) ì»¤ìŠ¤í„°ë§ˆì´ì§•
> 4. **ë ˆê±°ì‹œ ë§ˆì´ê·¸ë ˆì´ì…˜**: ê¸°ì¡´ AppWidget ì½”ë“œì˜ PendingIntent ë¡œì§ ì¬ì‚¬ìš©
> 5. **ë¯¸ë˜ í™•ì¥ì„±**: ì•„ì§ ë˜í¼ê°€ ì—†ëŠ” ìƒˆë¡œìš´ ìœ í˜•ì˜ ì•¡ì…˜
>
> **í•µì‹¬**: ë˜í¼ APIëŠ” **80%ì˜ ì¼ë°˜ì ì¸ ì‚¬ìš© ì‚¬ë¡€**ë¥¼ ì»¤ë²„í•˜ê³ , `action()`ì€ **ë‚˜ë¨¸ì§€ 20%ì˜ íŠ¹ìˆ˜ ì¼€ì´ìŠ¤**ë¥¼ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.

#### 2.5.2 ê¸°ë³¸ ì‚¬ìš©ë²•

```kotlin
Button(
    text = "ì»¤ìŠ¤í…€ ì•¡ì…˜",
    onClick = action(
        Intent(context, MyReceiver::class.java).apply {
            action = "com.example.CUSTOM_ACTION"
            putExtra("data", "value")
        }
    )
)
```

#### 2.5.3 ì‹¤ì „ ì‚¬ìš© ì‚¬ë¡€

##### ì‚¬ë¡€ 1: ì‹œìŠ¤í…œ ì „í™” ê±¸ê¸°

```kotlin
// ë˜í¼ APIë¡œëŠ” ë¶ˆê°€ëŠ¥ - ì‹œìŠ¤í…œ ë‹¤ì´ì–¼ëŸ¬ ì‹¤í–‰
Button(
    text = "ê¸´ê¸‰ ì „í™”",
    onClick = action(
        Intent(Intent.ACTION_DIAL).apply {
            data = Uri.parse("tel:119")
        }
    )
)
```

##### ì‚¬ë¡€ 2: ë¸Œë¼ìš°ì € URL ì—´ê¸°

```kotlin
// ë˜í¼ APIë¡œëŠ” ë¶ˆê°€ëŠ¥ - ì‹œìŠ¤í…œ ë¸Œë¼ìš°ì € ì‹¤í–‰
Button(
    text = "í™ˆí˜ì´ì§€ ì—´ê¸°",
    onClick = action(
        Intent(Intent.ACTION_VIEW).apply {
            data = Uri.parse("https://developer.android.com")
        }
    )
)
```

##### ì‚¬ë¡€ 3: ì‹œìŠ¤í…œ ì•ŒëŒ ì„¤ì •

```kotlin
// ì‹œìŠ¤í…œ ì•ŒëŒ ì•± ì—´ê¸° (íŠ¹ì • ì‹œê°„ìœ¼ë¡œ ì•ŒëŒ ì„¤ì •)
Button(
    text = "ì•ŒëŒ ì„¤ì •",
    onClick = action(
        Intent(AlarmClock.ACTION_SET_ALARM).apply {
            putExtra(AlarmClock.EXTRA_HOUR, 7)
            putExtra(AlarmClock.EXTRA_MINUTES, 30)
            putExtra(AlarmClock.EXTRA_MESSAGE, "ê¸°ìƒ ì•ŒëŒ")
        }
    )
)

// í•„ìš” ê¶Œí•œ: AndroidManifest.xml
// <uses-permission android:name="com.android.alarm.permission.SET_ALARM" />
```

##### ì‚¬ë¡€ 4: êµ¬ê¸€ ë§µ íŠ¹ì • ìœ„ì¹˜ ì—´ê¸°

```kotlin
// ì¨ë“œíŒŒí‹° ì•±(êµ¬ê¸€ ë§µ) ë”¥ë§í¬
Button(
    text = "ìœ„ì¹˜ ë³´ê¸°",
    onClick = action(
        Intent(Intent.ACTION_VIEW).apply {
            data = Uri.parse("geo:37.5665,126.9780?q=ì„œìš¸íŠ¹ë³„ì‹œì²­")
        }
    )
)
```

##### ì‚¬ë¡€ 5: ì´ë©”ì¼ ì‘ì„± (ê³µìœ  ì¸í…íŠ¸)

```kotlin
Button(
    text = "í”¼ë“œë°± ë³´ë‚´ê¸°",
    onClick = action(
        Intent(Intent.ACTION_SENDTO).apply {
            data = Uri.parse("mailto:")
            putExtra(Intent.EXTRA_EMAIL, arrayOf("support@example.com"))
            putExtra(Intent.EXTRA_SUBJECT, "ìœ„ì ¯ í”¼ë“œë°±")
            putExtra(Intent.EXTRA_TEXT, "ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”")
        }
    )
)
```

##### ì‚¬ë¡€ 6: PendingIntent í”Œë˜ê·¸ ì»¤ìŠ¤í„°ë§ˆì´ì§•

```kotlin
// íŠ¹ìˆ˜í•œ PendingIntent í”Œë˜ê·¸ê°€ í•„ìš”í•œ ê²½ìš°
// (ì˜ˆ: ê¸°ì¡´ PendingIntentë¥¼ ì·¨ì†Œí•˜ê³  ìƒˆë¡œ ìƒì„±)
val customIntent = Intent(context, MyActivity::class.java)
val pendingIntent = PendingIntent.getActivity(
    context,
    requestCode,
    customIntent,
    PendingIntent.FLAG_IMMUTABLE or PendingIntent.FLAG_CANCEL_CURRENT // ì„¸ë°€í•œ ì œì–´
)

Button(
    text = "íŠ¹ìˆ˜ ì•¡ì…˜",
    onClick = action(pendingIntent)
)
```

##### ì‚¬ë¡€ 7: ì‹œìŠ¤í…œ ì„¤ì • í™”ë©´ ì—´ê¸°

```kotlin
// Wi-Fi ì„¤ì • í™”ë©´ ì—´ê¸°
Button(
    text = "Wi-Fi ì„¤ì •",
    onClick = action(
        Intent(Settings.ACTION_WIFI_SETTINGS)
    )
)

// ì•± ìƒì„¸ ì„¤ì • í™”ë©´ ì—´ê¸° (ê¶Œí•œ ê´€ë¦¬)
Button(
    text = "ê¶Œí•œ ì„¤ì •",
    onClick = action(
        Intent(Settings.ACTION_APPLICATION_DETAILS_SETTINGS).apply {
            data = Uri.parse("package:${context.packageName}")
        }
    )
)
```

##### ì‚¬ë¡€ 8: ë‹¤ë¥¸ ì•± ì‹¤í–‰ (Package Name)

```kotlin
// íŠ¹ì • ì•±ì´ ì„¤ì¹˜ë˜ì–´ ìˆì„ ë•Œ ì‹¤í–‰
Button(
    text = "ì¹´ì¹´ì˜¤í†¡ ì—´ê¸°",
    onClick = action(
        context.packageManager.getLaunchIntentForPackage("com.kakao.talk")
            ?: Intent(Intent.ACTION_VIEW, Uri.parse("market://details?id=com.kakao.talk"))
    )
)
```

> [!NOTE] ğŸ’¬ ë°œí‘œ ì„¤ëª…
> "**action()ì„ ì‚¬ìš©í•˜ëŠ” 8ê°€ì§€ ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤**ë¥¼ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.
>
> **1-2. ì‹œìŠ¤í…œ ì•± ì‹¤í–‰**: ì „í™”, ë¸Œë¼ìš°ì €ëŠ” `Intent.ACTION_DIAL`, `Intent.ACTION_VIEW` ê°™ì€ ì‹œìŠ¤í…œ ì¸í…íŠ¸ë¡œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤. `actionStartActivity`ë¡œëŠ” ì•± ë‚´ Activityë§Œ ì‹¤í–‰í•  ìˆ˜ ìˆì£ .
>
> **3. ì‹œìŠ¤í…œ ì•ŒëŒ**: `AlarmClock.ACTION_SET_ALARM`ì€ ì‹œìŠ¤í…œ ì•ŒëŒ ì•±ì— íŠ¹ì • ì‹œê°„ ì•ŒëŒì„ ì„¤ì •í•˜ëŠ” íŠ¹ìˆ˜ ì•¡ì…˜ì…ë‹ˆë‹¤. ë˜í¼ APIë¡œëŠ” ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
>
> **4-5. ì¨ë“œíŒŒí‹° í†µí•©**: êµ¬ê¸€ ë§µ ë”¥ë§í¬(`geo:`)ë‚˜ ì´ë©”ì¼ ì‘ì„±(`mailto:`)ì€ ë‹¤ë¥¸ ì•±ê³¼ì˜ í†µí•©ì´ë¯€ë¡œ ì»¤ìŠ¤í…€ ì¸í…íŠ¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.
>
> **6. PendingIntent í”Œë˜ê·¸ ì œì–´**: `FLAG_CANCEL_CURRENT`, `FLAG_UPDATE_CURRENT`, `FLAG_ONE_SHOT` ë“± PendingIntentì˜ ì„¸ë°€í•œ ë™ì‘ì„ ì œì–´í•´ì•¼ í•  ë•Œ ì§ì ‘ ìƒì„±í•©ë‹ˆë‹¤.
>
> **7. ì‹œìŠ¤í…œ ì„¤ì •**: Wi-Fi ì„¤ì •ì´ë‚˜ ì•± ê¶Œí•œ ì„¤ì • í™”ë©´ì€ ì‹œìŠ¤í…œ Settings ì¸í…íŠ¸ë¡œë§Œ ì—´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
>
> **8. ë‹¤ë¥¸ ì•± ì‹¤í–‰**: ì¹´ì¹´ì˜¤í†¡ ê°™ì€ íŠ¹ì • ì•±ì„ íŒ¨í‚¤ì§€ëª…ìœ¼ë¡œ ì‹¤í–‰í•˜ê±°ë‚˜, ì—†ìœ¼ë©´ í”Œë ˆì´ìŠ¤í† ì–´ë¡œ ìœ ë„í•˜ëŠ” íŒ¨í„´ì…ë‹ˆë‹¤.
>
> **í•µì‹¬**: ì´ëŸ° ì‹œë‚˜ë¦¬ì˜¤ë“¤ì€ **Android í”Œë«í¼ì˜ í‘œì¤€ Intent ì‹œìŠ¤í…œì„ ì‚¬ìš©**í•´ì•¼ í•˜ë¯€ë¡œ Glanceì˜ ê³ ìˆ˜ì¤€ ë˜í¼ë¡œëŠ” ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. `action()`ì€ ì´ëŸ° **í”Œë«í¼ ìˆ˜ì¤€ì˜ í†µí•©**ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ê°•ë ¥í•œ íƒˆì¶œêµ¬ì…ë‹ˆë‹¤."

#### 2.5.4 ì‚¬ìš© ì‹œ ì£¼ì˜ì‚¬í•­

**âœ… ê¶Œì¥ ì‚¬ìš© ì¼€ì´ìŠ¤**
- ì‹œìŠ¤í…œ ì¸í…íŠ¸ (ì „í™”, ë¸Œë¼ìš°ì €, ì•ŒëŒ, ì„¤ì • ë“±)
- ì¨ë“œíŒŒí‹° ì•± í†µí•© (ë”¥ë§í¬, ê³µìœ )
- PendingIntent í”Œë˜ê·¸ ì»¤ìŠ¤í„°ë§ˆì´ì§•
- ë˜í¼ APIë¡œ ë¶ˆê°€ëŠ¥í•œ íŠ¹ìˆ˜ ì¼€ì´ìŠ¤

**âŒ í”¼í•´ì•¼ í•  ì¼€ì´ìŠ¤**
- ì•± ë‚´ Activity ì‹¤í–‰ â†’ `actionStartActivity` ì‚¬ìš©
- ìœ„ì ¯ ìƒíƒœ ë³€ê²½ â†’ `actionRunCallback` ì‚¬ìš©
- ì•± ë‚´ Broadcast â†’ `actionSendBroadcast` ì‚¬ìš©

**ë³´ì•ˆ ê³ ë ¤ì‚¬í•­**
```kotlin
// âŒ ì˜ëª»ëœ ì˜ˆ: exportedê°€ trueì¸ PendingIntent (ë³´ì•ˆ ìœ„í—˜)
val unsafeIntent = Intent(context, MyActivity::class.java)
val pendingIntent = PendingIntent.getActivity(
    context, 0, unsafeIntent,
    PendingIntent.FLAG_MUTABLE // âš ï¸ ìœ„í—˜: ë‹¤ë¥¸ ì•±ì´ ìˆ˜ì • ê°€ëŠ¥
)

// âœ… ì˜¬ë°”ë¥¸ ì˜ˆ: FLAG_IMMUTABLE ì‚¬ìš© (Android 12+)
val safeIntent = Intent(context, MyActivity::class.java)
val pendingIntent = PendingIntent.getActivity(
    context, 0, safeIntent,
    PendingIntent.FLAG_IMMUTABLE // âœ… ì•ˆì „: ìˆ˜ì • ë¶ˆê°€
)
```

> [!WARNING]
> **Android 12 (API 31) ì´ìƒì—ì„œëŠ” PendingIntent ìƒì„± ì‹œ `FLAG_IMMUTABLE` ë˜ëŠ” `FLAG_MUTABLE`ì„ ëª…ì‹œí•´ì•¼ í•©ë‹ˆë‹¤.** ëª…ì‹œí•˜ì§€ ì•Šìœ¼ë©´ í¬ë˜ì‹œê°€ ë°œìƒí•©ë‹ˆë‹¤. ë³´ì•ˆì„ ìœ„í•´ ê°€ëŠ¥í•˜ë©´ `FLAG_IMMUTABLE`ì„ ì‚¬ìš©í•˜ì„¸ìš”.

---

## 3. `ActionParameters`ë¡œ ë°ì´í„° ì „ë‹¬

`ActionCallback`ì— íŒŒë¼ë¯¸í„°ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```kotlin
// 1. íŒŒë¼ë¯¸í„° ì •ì˜
val itemIdKey = ActionParameters.Key<Int>("item_id")

// 2. í´ë¦­ ì‹œ íŒŒë¼ë¯¸í„° ì „ë‹¬
Button(
    text = "í•­ëª© ì‚­ì œ",
    onClick = actionRunCallback<DeleteItemAction>(
        parameters = actionParametersOf(itemIdKey to itemId)
    )
)

// 3. ActionCallbackì—ì„œ íŒŒë¼ë¯¸í„° ìˆ˜ì‹ 
class DeleteItemAction : ActionCallback {
    override suspend fun onAction(
        context: Context,
        glanceId: GlanceId,
        parameters: ActionParameters
    ) {
        val itemId = parameters[itemIdKey] ?: return

        // ì‚­ì œ ë¡œì§
        deleteItem(itemId)

        // UI ê°±ì‹ 
        MyWidget().update(context, glanceId)
    }
}
```

> [!NOTE] ğŸ’¬ ë°œí‘œ ì„¤ëª…
> "**ActionParametersëŠ” RemoteViewsì˜ PendingIntent ì œì•½ì„ ìš°íšŒí•˜ëŠ” ë°©ë²•**ì…ë‹ˆë‹¤.
>
> RemoteViewsëŠ” ì¼ë°˜ì ì¸ Composeì²˜ëŸ¼ ëŒë‹¤ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ëª¨ë“  ê²ƒì´ PendingIntentë¥¼ í†µí•´ì•¼ í•˜ë‹ˆê¹Œìš”. ê·¸ë˜ì„œ GlanceëŠ” **Key-Value ì‹œìŠ¤í…œ**ì„ ì œê³µí•©ë‹ˆë‹¤.
>
> 1. **Key ì •ì˜**: `ActionParameters.Key<Int>("item_id")` - íƒ€ì… ì•ˆì „í•œ í‚¤ë¥¼ ë§Œë“­ë‹ˆë‹¤.
> 2. **ì „ë‹¬**: `actionParametersOf(itemIdKey to itemId)` - í´ë¦­í•  ë•Œ ë°ì´í„°ë¥¼ í•¨ê»˜ ë³´ëƒ…ë‹ˆë‹¤.
> 3. **ìˆ˜ì‹ **: `parameters[itemIdKey]` - ActionCallbackì—ì„œ ì•ˆì „í•˜ê²Œ êº¼ëƒ…ë‹ˆë‹¤.
>
> ì´ë ‡ê²Œ í•˜ë©´ ë¦¬ìŠ¤íŠ¸ ìœ„ì ¯ì—ì„œ **ì–´ë–¤ í•­ëª©ì„ í´ë¦­í–ˆëŠ”ì§€** êµ¬ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°™ì€ ActionCallback í´ë˜ìŠ¤ë¥¼ ì¬ì‚¬ìš©í•˜ë©´ì„œë„ ë‹¤ë¥¸ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆì£ ."

**[ìŠ¤í¬ë¦°ìƒ· ì¶”ì²œ]** ë¦¬ìŠ¤íŠ¸ ìœ„ì ¯ì—ì„œ ê° í•­ëª©ì˜ ì‚­ì œ ë²„íŠ¼ ì˜ˆì‹œ

---

## 4. ë³µí•© Action íŒ¨í„´

### 4.1 ì¡°ê±´ë¶€ Action
```kotlin
Button(
    text = if (isLoggedIn) "ë¡œê·¸ì•„ì›ƒ" else "ë¡œê·¸ì¸",
    onClick = if (isLoggedIn) {
        actionRunCallback<LogoutAction>()
    } else {
        actionStartActivity<LoginActivity>()
    }
)
```

### 4.2 ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ì— ë™ì¼ Action
```kotlin
@Composable
fun ClickableCard(data: String) {
    Box(
        modifier = GlanceModifier
            .fillMaxWidth()
            .padding(8.dp)
            .background(Color.White)
            .clickable(
                onClick = actionRunCallback<CardClickAction>(
                    parameters = actionParametersOf(dataKey to data)
                )
            )
    ) {
        Text(data)
    }
}
```

---

## 5. Action ì²˜ë¦¬ ì‹œ ì£¼ì˜ì‚¬í•­

### 5.1 ìƒíƒœ ë³€ê²½ í›„ ë°˜ë“œì‹œ `update()` í˜¸ì¶œ

ìƒíƒœë¥¼ ë³€ê²½í•œ í›„ì—ëŠ” **ë°˜ë“œì‹œ `update()`ë¥¼ í˜¸ì¶œ**í•´ì•¼ UIì— ë°˜ì˜ë©ë‹ˆë‹¤.

```kotlin
updateAppWidgetState(context, glanceId) { prefs ->
    prefs[someKey] = newValue
}
MyWidget().update(context, glanceId) // í•„ìˆ˜!
```

> [!NOTE] ğŸ’¬ ë°œí‘œ ì„¤ëª…
> "**ê°€ì¥ í”í•œ ì‹¤ìˆ˜**ê°€ ë°”ë¡œ `update()` í˜¸ì¶œì„ ê¹Œë¨¹ëŠ” ê²ë‹ˆë‹¤.
>
> `updateAppWidgetState()`ëŠ” DataStoreì— ë°ì´í„°ë§Œ ì €ì¥í•©ë‹ˆë‹¤. íŒŒì¼ì— ì“°ëŠ” ê²ƒê³¼ ë¹„ìŠ·í•´ìš”. **í™”ë©´ ê°±ì‹ ê³¼ëŠ” ë³„ê°œì…ë‹ˆë‹¤.**
>
> `update()`ë¥¼ í˜¸ì¶œí•´ì•¼ `provideGlance()`ê°€ ë‹¤ì‹œ ì‹¤í–‰ë˜ê³ , `currentState<Preferences>()`ë¡œ ìƒˆë¡œìš´ ê°’ì„ ì½ì–´ì™€ì„œ UIê°€ ë‹¤ì‹œ ê·¸ë ¤ì§‘ë‹ˆë‹¤.
>
> ì´ ë‘ ë‹¨ê³„ê°€ ë¶„ë¦¬ëœ ì´ìœ ëŠ” **ë°°ì¹˜ ì—…ë°ì´íŠ¸**ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ê¸° ìœ„í•´ì„œì…ë‹ˆë‹¤. ì—¬ëŸ¬ ìƒíƒœë¥¼ í•œ ë²ˆì— ë°”ê¾¸ê³  ë§ˆì§€ë§‰ì— ë”± í•œ ë²ˆë§Œ `update()`ë¥¼ í˜¸ì¶œí•˜ë©´ ë˜ë‹ˆê¹Œìš”."

**ì—…ë°ì´íŠ¸ ë©”ì„œë“œì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ â†’ [3. Glance ìƒëª…ì£¼ê¸° & ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±°â­â­](3.%20Glance%20ìƒëª…ì£¼ê¸°%20&%20ì—…ë°ì´íŠ¸%20íŠ¸ë¦¬ê±°â­â­.md)** ì°¸ê³ 

### 5.2 ë¬´ê±°ìš´ ì‘ì—…ì€ `Worker`ë¡œ ë¶„ë¦¬
```kotlin
class HeavyAction : ActionCallback {
    override suspend fun onAction(
        context: Context,
        glanceId: GlanceId,
        parameters: ActionParameters
    ) {
        // âœ… ë„¤íŠ¸ì›Œí¬/DB ì‘ì—…ì€ WorkManagerë¡œ
        val workRequest = OneTimeWorkRequestBuilder<DataSyncWorker>()
            .setInputData(workDataOf("glance_id" to glanceId.toString()))
            .build()
        WorkManager.getInstance(context).enqueue(workRequest)

        // ì¦‰ì‹œ ë¡œë”© ìƒíƒœ í‘œì‹œ
        updateAppWidgetState(context, glanceId) { prefs ->
            prefs[booleanPreferencesKey("is_loading")] = true
        }
        MyWidget().update(context, glanceId)
    }
}
```

**[ë¹„ë””ì˜¤ ì¶”ì²œ]** ë²„íŠ¼ í´ë¦­ â†’ ë¡œë”© í‘œì‹œ â†’ ë°ì´í„° ë¡œë“œ ì™„ë£Œ â†’ ê²°ê³¼ í‘œì‹œ íë¦„

---

### 5.3 ì—ëŸ¬ ì²˜ë¦¬
```kotlin
class SafeAction : ActionCallback {
    override suspend fun onAction(
        context: Context,
        glanceId: GlanceId,
        parameters: ActionParameters
    ) {
        try {
            // ì‘ì—… ìˆ˜í–‰
            performTask()

            updateAppWidgetState(context, glanceId) { prefs ->
                prefs[stringPreferencesKey("status")] = "success"
            }
        } catch (e: Exception) {
            Log.e("SafeAction", "Error", e)
            updateAppWidgetState(context, glanceId) { prefs ->
                prefs[stringPreferencesKey("status")] = "error"
                prefs[stringPreferencesKey("error_msg")] = e.message ?: "Unknown"
            }
        } finally {
            MyWidget().update(context, glanceId)
        }
    }
}
```

---

## 6. ì‹¤ì „ ì˜ˆì œ: Todo ìœ„ì ¯

```kotlin
class TodoWidget : GlanceAppWidget() {
    override suspend fun provideGlance(context: Context, id: GlanceId) {
        provideContent {
            val prefs = currentState<Preferences>()
            val todos = prefs[stringPreferencesKey("todos")]?.split("|") ?: emptyList()

            Column(
                modifier = GlanceModifier.fillMaxSize().padding(16.dp)
            ) {
                Text("í•  ì¼ ëª©ë¡", style = TextStyle(fontSize = 18.sp, fontWeight = FontWeight.Bold))
                Spacer(GlanceModifier.height(8.dp))

                todos.forEach { todo ->
                    Row(
                        modifier = GlanceModifier.fillMaxWidth().padding(vertical = 4.dp),
                        verticalAlignment = Alignment.CenterVertically
                    ) {
                        Text(todo, modifier = GlanceModifier.defaultWeight())
                        Button(
                            text = "ì™„ë£Œ",
                            onClick = actionRunCallback<CompleteTodoAction>(
                                parameters = actionParametersOf(todoKey to todo)
                            )
                        )
                    }
                }

                Button(
                    text = "+ ì¶”ê°€",
                    onClick = actionStartActivity<AddTodoActivity>(),
                    modifier = GlanceModifier.fillMaxWidth()
                )
            }
        }
    }
}

class CompleteTodoAction : ActionCallback {
    override suspend fun onAction(
        context: Context,
        glanceId: GlanceId,
        parameters: ActionParameters
    ) {
        val todoToRemove = parameters[todoKey] ?: return

        updateAppWidgetState(context, glanceId) { prefs ->
            val todos = prefs[stringPreferencesKey("todos")]?.split("|")?.toMutableList() ?: mutableListOf()
            todos.remove(todoToRemove)
            prefs[stringPreferencesKey("todos")] = todos.joinToString("|")
        }

        TodoWidget().update(context, glanceId)
    }
}

private val todoKey = ActionParameters.Key<String>("todo_item")
```

**[ìŠ¤í¬ë¦°ìƒ· ì¶”ì²œ]** Todo ìœ„ì ¯ ì „ì²´ UI (ëª©ë¡ + ì™„ë£Œ ë²„íŠ¼ + ì¶”ê°€ ë²„íŠ¼)

---

---
