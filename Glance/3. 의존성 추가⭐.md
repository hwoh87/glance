> [!TIP] ğŸ—£ï¸ í•µì‹¬ë‚´ìš©
Glanceë¥¼ í”„ë¡œì íŠ¸ì— í†µí•©í•˜ê¸° ìœ„í•œ Gradle ì„¤ì •ê³¼ í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì•Œì•„ë´…ë‹ˆë‹¤.
>

## 1. Gradle ì„¤ì •

### 1.1 í”„ë¡œì íŠ¸ ë ˆë²¨ build.gradle.kts

```kotlin
// í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ build.gradle.kts
plugins {
    id("com.android.application") version "8.2.0" apply false
    id("org.jetbrains.kotlin.android") version "1.9.20" apply false
}
```

---

### 1.2 ëª¨ë“ˆ ë ˆë²¨ build.gradle.kts

```kotlin
plugins {
    id("com.android.application")
    id("org.jetbrains.kotlin.android")
}

android {
    namespace = "com.example.glancewidget"
    compileSdk = 34

    defaultConfig {
        applicationId = "com.example.glancewidget"
        minSdk = 23  // Glance ìµœì†Œ API 23
        targetSdk = 34
        versionCode = 1
        versionName = "1.0"
    }

    buildFeatures {
        compose = true
    }

    composeOptions {
        kotlinCompilerExtensionVersion = "1.5.4"
    }

    kotlinOptions {
        jvmTarget = "1.8"
    }
}

dependencies {
    // í•„ìˆ˜: Glance ìœ„ì ¯ ë¼ì´ë¸ŒëŸ¬ë¦¬
    implementation("androidx.glance:glance-appwidget:1.1.1")

    // ì¶”ì²œ: Material3 í…Œë§ˆ ì§€ì›
    implementation("androidx.glance:glance-material3:1.1.0")

    // í•„ìˆ˜: ìƒíƒœ ê´€ë¦¬ìš© DataStore
    implementation("androidx.datastore:datastore-preferences:1.1.1")

    // ì¶”ì²œ: ë°±ê·¸ë¼ìš´ë“œ ì‘ì—…ìš© WorkManager
    implementation("androidx.work:work-runtime-ktx:2.9.0")
}
```

---

## 2. ì˜ì¡´ì„± ì„¤ëª…

### 2.1 í•µì‹¬ ì˜ì¡´ì„±

| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ë²„ì „ | í•„ìˆ˜ ì—¬ë¶€ | ì„¤ëª… |
|-----------|------|----------|------|
| `glance-appwidget` | 1.1.1 | âœ… í•„ìˆ˜ | Glance ìœ„ì ¯ í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ |
| `datastore-preferences` | 1.1.1 | âœ… í•„ìˆ˜ | ìœ„ì ¯ ìƒíƒœ ì €ì¥ìš© |

### 2.2 ì¶”ì²œ ì˜ì¡´ì„±

| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ë²„ì „ | ìš©ë„ |
|-----------|------|------|
| `glance-material3` | 1.1.0 | Material3 ë””ìì¸ ì»´í¬ë„ŒíŠ¸ |
| `work-runtime-ktx` | 2.9.0 | ì£¼ê¸°ì  ì—…ë°ì´íŠ¸, ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… |

### 2.3 Proto DataStore ì‚¬ìš© ì‹œ ì¶”ê°€ ì˜ì¡´ì„±

ë³µì¡í•œ ë°ì´í„° êµ¬ì¡°ë¥¼ ë‹¤ë£° ë•Œ Proto DataStoreë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì¶”ê°€ ì˜ì¡´ì„±ì´ í•„ìš”í•©ë‹ˆë‹¤.

| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ë²„ì „ | ìš©ë„ |
|-----------|------|------|
| `datastore` (core) | 1.0.0 | Proto DataStore ì½”ì–´ |
| `protobuf-javalite` | 3.21.12 | Protocol Buffers ëŸ°íƒ€ì„ |
| Protobuf í”ŒëŸ¬ê·¸ì¸ | 0.9.4 | .proto íŒŒì¼ ì»´íŒŒì¼ |

> [!NOTE]
> Proto DataStoreëŠ” ë³µì¡í•œ ë°ì´í„° êµ¬ì¡°(ì¤‘ì²© ê°ì²´, ë¦¬ìŠ¤íŠ¸ ë“±)ë¥¼ ì €ì¥í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤. ê°„ë‹¨í•œ key-value ì €ì¥ë§Œ í•„ìš”í•˜ë‹¤ë©´ `datastore-preferences`ë§Œ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

---

## 3. Proto DataStore ì‚¬ìš© ì‹œ ì¶”ê°€ ì„¤ì •

> [!NOTE] ğŸ’¬ ë°œí‘œ ì„¤ëª…
> "**Proto DataStoreëŠ” Glance ì „ìš©ì´ ì•„ë‹™ë‹ˆë‹¤**. ì¼ë°˜ Android ì•±ì—ì„œë„ ì‚¬ìš©í•˜ëŠ” Jetpack DataStoreì˜ í•œ ì¢…ë¥˜ì…ë‹ˆë‹¤.
>
> - **Preferences DataStore**: ê°„ë‹¨í•œ key-value ì €ì¥ (Int, String, Boolean ë“±)
> - **Proto DataStore**: ë³µì¡í•œ ë°ì´í„° êµ¬ì¡°ë¥¼ Protocol Buffersë¡œ ì €ì¥ (ì¤‘ì²© ê°ì²´, ë¦¬ìŠ¤íŠ¸ ë“±)
>
> Glance ìœ„ì ¯ì—ì„œëŠ” **ìœ„ì ¯ ìƒíƒœê°€ ë³µì¡í•  ë•Œ** Proto DataStoreë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:
> - Todo ë¦¬ìŠ¤íŠ¸ (ê° í•­ëª©ì´ ì œëª©, ì™„ë£Œ ì—¬ë¶€, ìš°ì„ ìˆœìœ„ ë“±ì˜ í•„ë“œë¥¼ ê°€ì§)
> - ë‚ ì”¨ ì •ë³´ (ì˜¨ë„, ìŠµë„, í’ì†, ì˜ˆë³´ ë¦¬ìŠ¤íŠ¸ ë“±)
> - ì„¤ì • ì •ë³´ (ì—¬ëŸ¬ ì¹´í…Œê³ ë¦¬ì™€ í•˜ìœ„ ì˜µì…˜ë“¤)
>
> ì¼ë°˜ ì•±ì—ì„œë„ ë™ì¼í•œ ëª©ì ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. Glanceë§Œì˜ ê¸°ëŠ¥ì´ ì•„ë‹ˆë¼ **Android ì „ë°˜ì—ì„œ ì“°ëŠ” ë°ì´í„° ì €ì¥ ë°©ì‹**ì…ë‹ˆë‹¤."

ë³µì¡í•œ ë°ì´í„° êµ¬ì¡°ë¥¼ ë‹¤ë£° ë•ŒëŠ” Protocol Buffersë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 3.1 Protobuf í”ŒëŸ¬ê·¸ì¸ ì¶”ê°€

```kotlin
// ëª¨ë“ˆ ë ˆë²¨ build.gradle.kts
plugins {
    id("com.android.application")
    id("org.jetbrains.kotlin.android")
    id("com.google.protobuf") version "0.9.4"  // ì¶”ê°€
}

dependencies {
    // Proto DataStore
    implementation("androidx.datastore:datastore:1.0.0")
    implementation("com.google.protobuf:protobuf-javalite:3.21.12")
}

protobuf {
    protoc {
        artifact = "com.google.protobuf:protoc:3.21.12"
    }
    generateProtoTasks {
        all().forEach { task ->
            task.builtins {
                create("java") {
                    option("lite")
                }
            }
        }
    }
}
```

### 3.2 Proto íŒŒì¼ ìœ„ì¹˜

```
app/
â””â”€â”€ src/
    â””â”€â”€ main/
        â”œâ”€â”€ proto/
        â”‚   â””â”€â”€ widget_state.proto  â† ì—¬ê¸°ì— .proto íŒŒì¼ ìƒì„±
        â””â”€â”€ java/
```

**[ìŠ¤í¬ë¦°ìƒ· ì¶”ì²œ]** Android Studio í”„ë¡œì íŠ¸ êµ¬ì¡°ì—ì„œ proto í´ë” ìœ„ì¹˜

---

## 4. ë²„ì „ ì¹´íƒˆë¡œê·¸ ì‚¬ìš© (ê¶Œì¥)

ìµœì‹  í”„ë¡œì íŠ¸ëŠ” `libs.versions.toml`ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

### 4.1 gradle/libs.versions.toml

```toml
[versions]
glance = "1.1.1"
glanceMaterial = "1.1.0"
datastore = "1.1.1"
work = "2.9.0"
compose = "1.5.4"

[libraries]
glance-appwidget = { module = "androidx.glance:glance-appwidget", version.ref = "glance" }
glance-material3 = { module = "androidx.glance:glance-material3", version.ref = "glanceMaterial" }
datastore-preferences = { module = "androidx.datastore:datastore-preferences", version.ref = "datastore" }
work-runtime = { module = "androidx.work:work-runtime-ktx", version.ref = "work" }

[bundles]
glance = ["glance-appwidget", "glance-material3", "datastore-preferences"]
```

### 4.2 build.gradle.ktsì—ì„œ ì‚¬ìš©

```kotlin
dependencies {
    // ë²ˆë“¤ë¡œ í•œ ë²ˆì— ì¶”ê°€
    implementation(libs.bundles.glance)
    implementation(libs.work.runtime)

    // ë˜ëŠ” ê°œë³„ ì¶”ê°€
    implementation(libs.glance.appwidget)
    implementation(libs.glance.material3)
}
```

---

## 5. AndroidManifest.xml ê¶Œí•œ ì„¤ì •

```xml
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android">

    <!-- ì¸í„°ë„· ì‚¬ìš© (API í˜¸ì¶œ ì‹œ) -->
    <uses-permission android:name="android.permission.INTERNET" />

    <!-- ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í™•ì¸ (ì„ íƒ) -->
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

    <application
        android:name=".MyApplication"
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/Theme.MyApp">

        <!-- ìœ„ì ¯ Receiver ë“±ë¡ -->
        <receiver
            android:name=".widget.MyWidgetReceiver"
            android:exported="true">
            <intent-filter>
                <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
            </intent-filter>
            <meta-data
                android:name="android.appwidget.provider"
                android:resource="@xml/my_widget_info" />
        </receiver>

    </application>

</manifest>
```

---

## 6. ProGuard / R8 ê·œì¹™

release ë¹Œë“œ ì‹œ ë‚œë…í™”ë¡œ ì¸í•œ ë¬¸ì œë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.

> [!NOTE] ğŸ’¬ ë°œí‘œ ì„¤ëª…
> "Release ë¹Œë“œí•  ë•Œ **ProGuard/R8 ê·œì¹™**ì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì•ˆ ë„£ìœ¼ë©´ ìœ„ì ¯ì´ ëŸ°íƒ€ì„ì— í¬ë˜ì‹œ ë‚  ìˆ˜ ìˆì–´ìš”.
>
> GlanceëŠ” **ë¦¬í”Œë ‰ì…˜**ìœ¼ë¡œ í´ë˜ìŠ¤ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤. ActionCallback, GlanceAppWidget, GlanceAppWidgetReceiver ê°™ì€ í´ë˜ìŠ¤ë“¤ì„ ì‹œìŠ¤í…œì´ ëŸ°íƒ€ì„ì— ì°¾ì•„ì„œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì–´ìš”.
>
> ê·¼ë° ProGuardê°€ ë‚œë…í™”í•˜ë©´ í´ë˜ìŠ¤ ì´ë¦„ì´ `a`, `b`, `c` ê°™ì€ ê±¸ë¡œ ë°”ë€Œê³ , ì•ˆ ì“°ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ëŠ” ìƒì„±ìëŠ” ì•„ì˜ˆ ì œê±°ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ Glanceê°€ í´ë˜ìŠ¤ë¥¼ ëª» ì°¾ê±°ë‚˜ ìƒì„±ìë¥¼ ëª» í˜¸ì¶œí•´ì„œ í¬ë˜ì‹œê°€ ë‚˜ì£ .
>
> `-keep class` ê·œì¹™ì€ 'ì´ í´ë˜ìŠ¤ëŠ” ë‚œë…í™”í•˜ì§€ ë§ˆ' ë¼ëŠ” ëœ»ì´ê³ , `public <init>()` ê·œì¹™ì€ 'ê¸°ë³¸ ìƒì„±ì ì œê±°í•˜ì§€ ë§ˆ'ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤. WorkManagerì˜ Worker í´ë˜ìŠ¤ë„ ë§ˆì°¬ê°€ì§€ ì´ìœ ë¡œ keepì´ í•„ìš”í•©ë‹ˆë‹¤."

### 6.1 proguard-rules.pro

```proguard
# Glance
-keep class androidx.glance.** { *; }
-dontwarn androidx.glance.**

# DataStore
-keep class androidx.datastore.** { *; }
-dontwarn androidx.datastore.**

# Protobuf (Proto DataStore ì‚¬ìš© ì‹œ)
-keep class * extends com.google.protobuf.GeneratedMessageLite { *; }

# WorkManager
-keep class * extends androidx.work.Worker
-keep class * extends androidx.work.CoroutineWorker

# ActionCallback
-keep class * implements androidx.glance.action.ActionCallback {
    public <init>();
}

# GlanceAppWidget
-keep class * extends androidx.glance.appwidget.GlanceAppWidget {
    public <init>();
}

# GlanceAppWidgetReceiver
-keep class * extends androidx.glance.appwidget.GlanceAppWidgetReceiver {
    public <init>();
}
```

**[ìŠ¤í¬ë¦°ìƒ· ì¶”ì²œ]** ProGuard ì„¤ì • íŒŒì¼ ìœ„ì¹˜ (app/proguard-rules.pro)

---

## 7. ì˜ì¡´ì„± í™•ì¸

### 7.1 Gradle Sync
```bash
# Android Studioì—ì„œ
File > Sync Project with Gradle Files
```

### 7.2 ì˜ì¡´ì„± íŠ¸ë¦¬ í™•ì¸
```bash
./gradlew :app:dependencies
```

ì¶œë ¥ ì˜ˆì‹œ:
```
+--- androidx.glance:glance-appwidget:1.0.0
|    +--- androidx.glance:glance:1.0.0
|    +--- androidx.datastore:datastore-preferences:1.0.0
|    \--- androidx.compose.ui:ui:1.5.4
+--- androidx.glance:glance-material3:1.0.0
...
```

---

## 8. ë²„ì „ í˜¸í™˜ì„±

### 8.1 ìµœì†Œ ìš”êµ¬ì‚¬í•­

| í•­ëª©                    | ë²„ì „               |
| --------------------- | ---------------- |
| Android Gradle Plugin | 7.0+             |
| Kotlin                | 1.8.0+           |
| minSdk                | 23 (Android 6.0) |
| compileSdk            | 33+              |
| Compose Compiler      | 1.5.0+           |

### 8.2 ê¶Œì¥ ë²„ì „

| í•­ëª© | ë²„ì „ |
|------|------|
| Android Gradle Plugin | 8.2.0+ |
| Kotlin | 1.9.20+ |
| targetSdk | 34 |
| Compose Compiler | 1.5.4+ |

---

## 9. ì¼ë°˜ì ì¸ ë¬¸ì œ í•´ê²°

### 9.1 "Unresolved reference: glance"

**ì›ì¸**: Gradle Syncê°€ ì™„ë£Œë˜ì§€ ì•ŠìŒ

**í•´ê²°**:
```bash
# 1. Clean & Rebuild
./gradlew clean build

# 2. Invalidate Caches
Android Studio > File > Invalidate Caches > Invalidate and Restart
```

---

### 9.2 "Duplicate class androidx.glance..."

**ì›ì¸**: ì¤‘ë³µ ì˜ì¡´ì„±

**í•´ê²°**: build.gradle.ktsì—ì„œ ì¤‘ë³µ ì œê±°
```kotlin
dependencies {
    implementation("androidx.glance:glance-appwidget:1.0.0")
    // âŒ implementation("androidx.glance:glance:1.0.0")  // ì¤‘ë³µ, ì œê±°

    implementation("androidx.glance:glance-material3:1.0.0")
}
```

---

### 9.3 Proto íŒŒì¼ ë¹Œë“œ ì‹¤íŒ¨

**ì›ì¸**: Protobuf í”ŒëŸ¬ê·¸ì¸ ì„¤ì • ì˜¤ë¥˜

**í•´ê²°**:
```kotlin
// 1. í”ŒëŸ¬ê·¸ì¸ ë²„ì „ í™•ì¸
plugins {
    id("com.google.protobuf") version "0.9.4"
}

// 2. Sync í›„ Build > Rebuild Project
```

---

## 10. ì²´í¬ë¦¬ìŠ¤íŠ¸

### ê¸°ë³¸ ì„¤ì •
- [ ] `glance-appwidget` ì˜ì¡´ì„± ì¶”ê°€
- [ ] `datastore-preferences` ì˜ì¡´ì„± ì¶”ê°€
- [ ] `glance-material3` ì˜ì¡´ì„± ì¶”ê°€ (ì¶”ì²œ)
- [ ] `work-runtime-ktx` ì˜ì¡´ì„± ì¶”ê°€ (ì¶”ì²œ)
- [ ] Compose ì„¤ì • (`buildFeatures.compose = true`)
- [ ] minSdk 23 ì´ìƒ ì„¤ì •
- [ ] AndroidManifest.xmlì— Receiver ë“±ë¡
- [ ] ProGuard ê·œì¹™ ì¶”ê°€ (release ë¹Œë“œ ì‹œ)
- [ ] Gradle Sync ì„±ê³µ

### Proto DataStore ì‚¬ìš© ì‹œ ì¶”ê°€
- [ ] `datastore` (core) ì˜ì¡´ì„± ì¶”ê°€
- [ ] `protobuf-javalite` ì˜ì¡´ì„± ì¶”ê°€
- [ ] Protobuf í”ŒëŸ¬ê·¸ì¸ ì„¤ì •
- [ ] `app/src/main/proto/` ë””ë ‰í† ë¦¬ ìƒì„±
- [ ] Protobuf ê·œì¹™ì„ ProGuardì— ì¶”ê°€

---

---
