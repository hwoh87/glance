> [!TIP] ğŸ—£ï¸ í•µì‹¬ë‚´ìš©
Glanceë¥¼ í”„ë¡œì íŠ¸ì— í†µí•©í•˜ê¸° ìœ„í•œ Gradle ì„¤ì •ê³¼ í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì•Œì•„ë´…ë‹ˆë‹¤.
>

## 1. Gradle ì˜ì¡´ì„± ì¶”ê°€

### 1.1 ëª¨ë“ˆ ë ˆë²¨ build.gradle.kts

```kotlin
android {
    compileSdk = 34

    defaultConfig {
        minSdk = 23  // â­ Glance ìµœì†Œ ìš”êµ¬ì‚¬í•­
        targetSdk = 34
    }

    buildFeatures {
        compose = true  // â­ Glance í•„ìˆ˜
    }

    composeOptions {
        kotlinCompilerExtensionVersion = "1.5.4"  // â­ Compose Compiler ë²„ì „
    }
}

dependencies {
    // í•„ìˆ˜: Glance ìœ„ì ¯ ë¼ì´ë¸ŒëŸ¬ë¦¬
    implementation("androidx.glance:glance-appwidget:1.1.1")

    // ì¶”ì²œ: Material3 í…Œë§ˆ ì§€ì›
    implementation("androidx.glance:glance-material3:1.1.0")

    // í•„ìˆ˜: ìƒíƒœ ê´€ë¦¬ìš© DataStore
    implementation("androidx.datastore:datastore-preferences:1.1.1")

    // ì¶”ì²œ: ë°±ê·¸ë¼ìš´ë“œ ì‘ì—…ìš© WorkManager
    implementation("androidx.work:work-runtime-ktx:2.9.0")
}
```

> [!NOTE]
> **í•µì‹¬ ì„¤ì •**:
> - **minSdk 23**: Glanceì˜ ìµœì†Œ ì§€ì› ë²„ì „
> - **compose = true**: GlanceëŠ” Compose DSL ê¸°ë°˜ìœ¼ë¡œ ì‘ë™
> - **composeOptions**: Kotlin ë²„ì „ê³¼ í˜¸í™˜ë˜ëŠ” Compose Compiler ë²„ì „ í•„ìš”

---

## 2. ì˜ì¡´ì„± ì„¤ëª…

### 2.1 í•µì‹¬ ì˜ì¡´ì„±

| ë¼ì´ë¸ŒëŸ¬ë¦¬                   | ë²„ì „    | í•„ìˆ˜ ì—¬ë¶€ | ì„¤ëª…                 |
| ----------------------- | ----- | ----- | ------------------ |
| `glance-appwidget`      | 1.1.1 | âœ… í•„ìˆ˜  | Glance ìœ„ì ¯ í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ |
| `datastore-preferences` | 1.1.1 | âœ… í•„ìˆ˜  | ìœ„ì ¯ ìƒíƒœ ì €ì¥ìš©          |

### 2.2 ì¶”ì²œ ì˜ì¡´ì„±

| ë¼ì´ë¸ŒëŸ¬ë¦¬              | ë²„ì „    | ìš©ë„                 |
| ------------------ | ----- | ------------------ |
| `glance-material3` | 1.1.0 | Material3 ë””ìì¸ ì»´í¬ë„ŒíŠ¸ |
| `work-runtime-ktx` | 2.9.0 | ì£¼ê¸°ì  ì—…ë°ì´íŠ¸, ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… |

### 2.3 Proto DataStore ì‚¬ìš© ì‹œ ì¶”ê°€ ì˜ì¡´ì„±

ë³µì¡í•œ ë°ì´í„° êµ¬ì¡°ë¥¼ ë‹¤ë£° ë•Œ Proto DataStoreë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì¶”ê°€ ì˜ì¡´ì„±ì´ í•„ìš”í•©ë‹ˆë‹¤.

| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ë²„ì „ | ìš©ë„ |
|-----------|------|------|
| `datastore` (core) | 1.0.0 | Proto DataStore ì½”ì–´ |
| `protobuf-javalite` | 3.21.12 | Protocol Buffers ëŸ°íƒ€ì„ |
| Protobuf í”ŒëŸ¬ê·¸ì¸ | 0.9.4 | .proto íŒŒì¼ ì»´íŒŒì¼ |

> [!NOTE]
> Proto DataStoreëŠ” ë³µì¡í•œ ë°ì´í„° êµ¬ì¡°(ì¤‘ì²© ê°ì²´, ë¦¬ìŠ¤íŠ¸ ë“±)ë¥¼ ì €ì¥í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤. ê°„ë‹¨í•œ key-value ì €ì¥ë§Œ í•„ìš”í•˜ë‹¤ë©´ `datastore-preferences`ë§Œ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

---

## 3. Proto DataStore ì‚¬ìš© ì‹œ ì¶”ê°€ ì„¤ì •

> [!NOTE] ğŸ’¬ ë°œí‘œ ì„¤ëª…
> "**Proto DataStoreëŠ” Glance ì „ìš©ì´ ì•„ë‹™ë‹ˆë‹¤**. ì¼ë°˜ Android ì•±ì—ì„œë„ ì‚¬ìš©í•˜ëŠ” Jetpack DataStoreì˜ í•œ ì¢…ë¥˜ì…ë‹ˆë‹¤.
>
> - **Preferences DataStore**: ê°„ë‹¨í•œ key-value ì €ì¥ (Int, String, Boolean ë“±)
> - **Proto DataStore**: ë³µì¡í•œ ë°ì´í„° êµ¬ì¡°ë¥¼ Protocol Buffersë¡œ ì €ì¥ (ì¤‘ì²© ê°ì²´, ë¦¬ìŠ¤íŠ¸ ë“±)
>
> Glance ìœ„ì ¯ì—ì„œëŠ” **ìœ„ì ¯ ìƒíƒœê°€ ë³µì¡í•  ë•Œ** Proto DataStoreë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:
> - Todo ë¦¬ìŠ¤íŠ¸ (ê° í•­ëª©ì´ ì œëª©, ì™„ë£Œ ì—¬ë¶€, ìš°ì„ ìˆœìœ„ ë“±ì˜ í•„ë“œë¥¼ ê°€ì§)
> - ë‚ ì”¨ ì •ë³´ (ì˜¨ë„, ìŠµë„, í’ì†, ì˜ˆë³´ ë¦¬ìŠ¤íŠ¸ ë“±)
> - ì„¤ì • ì •ë³´ (ì—¬ëŸ¬ ì¹´í…Œê³ ë¦¬ì™€ í•˜ìœ„ ì˜µì…˜ë“¤)
>
> ì¼ë°˜ ì•±ì—ì„œë„ ë™ì¼í•œ ëª©ì ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. Glanceë§Œì˜ ê¸°ëŠ¥ì´ ì•„ë‹ˆë¼ **Android ì „ë°˜ì—ì„œ ì“°ëŠ” ë°ì´í„° ì €ì¥ ë°©ì‹**ì…ë‹ˆë‹¤."

ë³µì¡í•œ ë°ì´í„° êµ¬ì¡°ë¥¼ ë‹¤ë£° ë•ŒëŠ” Protocol Buffersë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 3.1 Protobuf í”ŒëŸ¬ê·¸ì¸ ì¶”ê°€

```kotlin
// ëª¨ë“ˆ ë ˆë²¨ build.gradle.kts
plugins {
    id("com.android.application")
    id("org.jetbrains.kotlin.android")
    id("com.google.protobuf") version "0.9.4"  // ì¶”ê°€
}

dependencies {
    // Proto DataStore
    implementation("androidx.datastore:datastore:1.0.0")
    implementation("com.google.protobuf:protobuf-javalite:3.21.12")
}

protobuf {
    protoc {
        artifact = "com.google.protobuf:protoc:3.21.12"
    }
    generateProtoTasks {
        all().forEach { task ->
            task.builtins {
                create("java") {
                    option("lite")
                }
            }
        }
    }
}
```

### 3.2 Proto íŒŒì¼ ìœ„ì¹˜

```
app/
â””â”€â”€ src/
    â””â”€â”€ main/
        â”œâ”€â”€ proto/
        â”‚   â””â”€â”€ widget_state.proto  â† ì—¬ê¸°ì— .proto íŒŒì¼ ìƒì„±
        â””â”€â”€ java/
```

**[ìŠ¤í¬ë¦°ìƒ· ì¶”ì²œ]** Android Studio í”„ë¡œì íŠ¸ êµ¬ì¡°ì—ì„œ proto í´ë” ìœ„ì¹˜

---

## 4. ë²„ì „ ì¹´íƒˆë¡œê·¸ ì‚¬ìš© (ê¶Œì¥)

ìµœì‹  í”„ë¡œì íŠ¸ëŠ” `libs.versions.toml`ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

### 4.1 gradle/libs.versions.toml

```toml
[versions]
glance = "1.1.1"
glanceMaterial = "1.1.0"
datastore = "1.1.1"
work = "2.9.0"
compose = "1.5.4"

[libraries]
glance-appwidget = { module = "androidx.glance:glance-appwidget", version.ref = "glance" }
glance-material3 = { module = "androidx.glance:glance-material3", version.ref = "glanceMaterial" }
datastore-preferences = { module = "androidx.datastore:datastore-preferences", version.ref = "datastore" }
work-runtime = { module = "androidx.work:work-runtime-ktx", version.ref = "work" }

[bundles]
glance = ["glance-appwidget", "glance-material3", "datastore-preferences"]
```

### 4.2 build.gradle.ktsì—ì„œ ì‚¬ìš©

```kotlin
dependencies {
    // ë²ˆë“¤ë¡œ í•œ ë²ˆì— ì¶”ê°€
    implementation(libs.bundles.glance)
    implementation(libs.work.runtime)

    // ë˜ëŠ” ê°œë³„ ì¶”ê°€
    implementation(libs.glance.appwidget)
    implementation(libs.glance.material3)
}
```

---

## 5. AndroidManifest.xml ìœ„ì ¯ ë“±ë¡

```xml
<manifest xmlns:android="http://schemas.android.com/apk/res/android">
    <application>
        <!-- â­ Glance ìœ„ì ¯ Receiver ë“±ë¡ (í•„ìˆ˜) -->
        <receiver
            android:name=".widget.MyWidgetReceiver"
            android:exported="true">
            <intent-filter>
                <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
            </intent-filter>
            <meta-data
                android:name="android.appwidget.provider"
                android:resource="@xml/my_widget_info" />
        </receiver>
    </application>
</manifest>
```

> [!NOTE]
> **í•µì‹¬ ìš”ì†Œ**:
> - **android:exported="true"**: ì‹œìŠ¤í…œ(ëŸ°ì²˜)ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ í•„ìˆ˜
> - **APPWIDGET_UPDATE**: ìœ„ì ¯ ì—…ë°ì´íŠ¸ ë¸Œë¡œë“œìºìŠ¤íŠ¸ ìˆ˜ì‹ 
> - **meta-data**: ìœ„ì ¯ ì„¤ì • ì •ë³´ XML ì—°ê²° (í¬ê¸°, ì—…ë°ì´íŠ¸ ì£¼ê¸° ë“±)

---

## 6. ProGuard / R8 ê·œì¹™

release ë¹Œë“œ ì‹œ ë‚œë…í™”ë¡œ ì¸í•œ ë¬¸ì œë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.

> [!NOTE] ğŸ’¬ ë°œí‘œ ì„¤ëª…
> "Release ë¹Œë“œí•  ë•Œ **ProGuard/R8 ê·œì¹™**ì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì•ˆ ë„£ìœ¼ë©´ ìœ„ì ¯ì´ ëŸ°íƒ€ì„ì— í¬ë˜ì‹œ ë‚  ìˆ˜ ìˆì–´ìš”.
>
> GlanceëŠ” **ë¦¬í”Œë ‰ì…˜**ìœ¼ë¡œ í´ë˜ìŠ¤ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤. ActionCallback, GlanceAppWidget, GlanceAppWidgetReceiver ê°™ì€ í´ë˜ìŠ¤ë“¤ì„ ì‹œìŠ¤í…œì´ ëŸ°íƒ€ì„ì— ì°¾ì•„ì„œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì–´ìš”.
>
> ê·¼ë° ProGuardê°€ ë‚œë…í™”í•˜ë©´ í´ë˜ìŠ¤ ì´ë¦„ì´ `a`, `b`, `c` ê°™ì€ ê±¸ë¡œ ë°”ë€Œê³ , ì•ˆ ì“°ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ëŠ” ìƒì„±ìëŠ” ì•„ì˜ˆ ì œê±°ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ Glanceê°€ í´ë˜ìŠ¤ë¥¼ ëª» ì°¾ê±°ë‚˜ ìƒì„±ìë¥¼ ëª» í˜¸ì¶œí•´ì„œ í¬ë˜ì‹œê°€ ë‚˜ì£ .
>
> `-keep class` ê·œì¹™ì€ 'ì´ í´ë˜ìŠ¤ëŠ” ë‚œë…í™”í•˜ì§€ ë§ˆ' ë¼ëŠ” ëœ»ì´ê³ , `public <init>()` ê·œì¹™ì€ 'ê¸°ë³¸ ìƒì„±ì ì œê±°í•˜ì§€ ë§ˆ'ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤. WorkManagerì˜ Worker í´ë˜ìŠ¤ë„ ë§ˆì°¬ê°€ì§€ ì´ìœ ë¡œ keepì´ í•„ìš”í•©ë‹ˆë‹¤."

### 6.1 proguard-rules.pro

```proguard
# Glance
-keep class androidx.glance.** { *; }
-dontwarn androidx.glance.**

# DataStore
-keep class androidx.datastore.** { *; }
-dontwarn androidx.datastore.**

# Protobuf (Proto DataStore ì‚¬ìš© ì‹œ)
-keep class * extends com.google.protobuf.GeneratedMessageLite { *; }

# WorkManager
-keep class * extends androidx.work.Worker
-keep class * extends androidx.work.CoroutineWorker

# ActionCallback
-keep class * implements androidx.glance.action.ActionCallback {
    public <init>();
}

# GlanceAppWidget
-keep class * extends androidx.glance.appwidget.GlanceAppWidget {
    public <init>();
}

# GlanceAppWidgetReceiver
-keep class * extends androidx.glance.appwidget.GlanceAppWidgetReceiver {
    public <init>();
}
```

**[ìŠ¤í¬ë¦°ìƒ· ì¶”ì²œ]** ProGuard ì„¤ì • íŒŒì¼ ìœ„ì¹˜ (app/proguard-rules.pro)

---

## 7. ì˜ì¡´ì„± íŠ¸ë¦¬ í™•ì¸

Glanceê°€ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
./gradlew :app:dependencies
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
+--- androidx.glance:glance-appwidget:1.1.1
|    +--- androidx.glance:glance:1.1.1
|    |    +--- androidx.compose.runtime:runtime:1.5.4
|    |    +--- androidx.compose.ui:ui:1.5.4
|    |    \--- org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.3
|    +--- androidx.datastore:datastore-preferences:1.0.0
|    \--- androidx.work:work-runtime-ktx:2.8.0
+--- androidx.glance:glance-material3:1.1.0
|    +--- androidx.compose.material3:material3:1.1.2
|    \--- androidx.glance:glance-appwidget:1.1.1
...
```

> [!NOTE]
> ì˜ì¡´ì„± íŠ¸ë¦¬ë¥¼ í†µí•´ Glanceê°€ ë‚´ë¶€ì ìœ¼ë¡œ Compose Runtime, UI, Coroutines ë“±ì„ ì‚¬ìš©í•¨ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë²„ì „ ì¶©ëŒì´ ë°œìƒí•˜ë©´ ì´ ëª…ë ¹ìœ¼ë¡œ ì›ì¸ì„ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## 8. ë²„ì „ í˜¸í™˜ì„±

| í•­ëª©         | ìµœì†Œ ë²„ì „            | ê¶Œì¥ ë²„ì „     |
| ---------- | ---------------- | --------- |
| minSdk     | 23 (Android 6.0) | 23+       |
| compileSdk | 33+              | 34        |
| Kotlin     | 1.8.0+           | 1.9.20+   |
| Compose    | 1.5.0+           | 1.5.4+    |

> [!IMPORTANT]
> **minSdk 23**ì€ Glanceì˜ ì ˆëŒ€ ìµœì†Œ ìš”êµ¬ì‚¬í•­ì…ë‹ˆë‹¤. Android 6.0 ë¯¸ë§Œì—ì„œëŠ” Glance ìœ„ì ¯ì´ ë™ì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

---

## 9. ì²´í¬ë¦¬ìŠ¤íŠ¸

### ê¸°ë³¸ ì„¤ì •
- [ ] `glance-appwidget` ì˜ì¡´ì„± ì¶”ê°€
- [ ] `datastore-preferences` ì˜ì¡´ì„± ì¶”ê°€
- [ ] `glance-material3` ì˜ì¡´ì„± ì¶”ê°€ (ì¶”ì²œ)
- [ ] `work-runtime-ktx` ì˜ì¡´ì„± ì¶”ê°€ (ì¶”ì²œ)
- [ ] Compose ì„¤ì • (`buildFeatures.compose = true`)
- [ ] minSdk 23 ì´ìƒ ì„¤ì •
- [ ] AndroidManifest.xmlì— Receiver ë“±ë¡
- [ ] ProGuard ê·œì¹™ ì¶”ê°€ (release ë¹Œë“œ ì‹œ)

### Proto DataStore ì‚¬ìš© ì‹œ ì¶”ê°€
- [ ] `datastore` (core) ì˜ì¡´ì„± ì¶”ê°€
- [ ] `protobuf-javalite` ì˜ì¡´ì„± ì¶”ê°€
- [ ] Protobuf í”ŒëŸ¬ê·¸ì¸ ì„¤ì •
- [ ] `app/src/main/proto/` ë””ë ‰í† ë¦¬ ìƒì„±
- [ ] Protobuf ê·œì¹™ì„ ProGuardì— ì¶”ê°€

---
